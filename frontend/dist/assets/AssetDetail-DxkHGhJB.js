import{aS as E,k as L,u as O,r as n,b as P,c as p,j as e,bo as M,bn as $,bp as q,b3 as z,bN as g,L as j,b5 as v,b7 as B,bH as F,bI as Q,bJ as K,bK as V,bL as N,bM as W,aD as d,bs as J}from"./vendor-CWk44mA8.js";import{B as y,y as b}from"./index-CiJwl-Bo.js";import{b as U,c as w}from"./Skeleton-DVOICtGK.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const C=[{value:"server",label:"Server",icon:F},{value:"workstation",label:"Workstation",icon:Q},{value:"mobile",label:"Mobile",icon:K},{value:"network",label:"Network",icon:V},{value:"application",label:"Application",icon:N},{value:"data",label:"Data",icon:N},{value:"cloud",label:"Cloud",icon:W}],S=[{value:"low",label:"Low",color:"bg-surface-500"},{value:"medium",label:"Medium",color:"bg-amber-500"},{value:"high",label:"High",color:"bg-orange-500"},{value:"critical",label:"Critical",color:"bg-red-500"}],Y=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"decommissioned",label:"Decommissioned"}];function te(){const{id:c}=E(),o=L(),x=O(),[k,i]=n.useState(!1),[D,f]=n.useState(!1),[r,l]=n.useState({name:"",type:"workstation",category:"",status:"active",criticality:"medium",owner:"",location:"",department:"",description:"",rtoHours:void 0,rpoHours:void 0,bcdrCriticality:"",recoveryNotes:""}),{data:s,isLoading:A}=P({queryKey:["asset",c],queryFn:async()=>(await b.get(c)).data,enabled:!!c});n.useEffect(()=>{s&&l({name:s.name||"",type:s.type||"workstation",category:s.category||"",status:s.status||"active",criticality:s.criticality||"medium",owner:s.owner||"",location:s.location||"",department:s.department||"",description:s.description||"",rtoHours:s.rtoHours||void 0,rpoHours:s.rpoHours||void 0,bcdrCriticality:s.bcdrCriticality||"",recoveryNotes:s.recoveryNotes||""})},[s]);const m=p({mutationFn:async t=>(await b.update(c,t)).data,onSuccess:()=>{x.invalidateQueries({queryKey:["asset",c]}),x.invalidateQueries({queryKey:["assets"]}),i(!1),d.success("Asset updated successfully")},onError:()=>d.error("Failed to update asset")}),u=p({mutationFn:async()=>{await b.delete(c)},onSuccess:()=>{x.invalidateQueries({queryKey:["assets"]}),d.success("Asset deleted successfully"),o("/assets")},onError:()=>d.error("Failed to delete asset")}),R=t=>S.find(h=>h.value===t)?.color||"bg-surface-500",H=t=>{switch(t){case"active":return"bg-emerald-500/20 text-emerald-400";case"inactive":return"bg-surface-500/20 text-surface-400";case"decommissioned":return"bg-red-500/20 text-red-400";default:return"bg-surface-500/20 text-surface-400"}},T=t=>{const h=C.find(I=>I.value===t)?.icon||J;return e.jsx(h,{className:"w-8 h-8 text-surface-400"})},_=t=>{switch(t){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-amber-500";case"low":return"bg-emerald-500";default:return"bg-surface-500"}};return A?e.jsxs("div",{className:"space-y-6",children:[e.jsx(U,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(w,{})}),e.jsx("div",{children:e.jsx(w,{})})]})]}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>o("/assets"),className:"p-2 hover:bg-surface-700 rounded-lg text-surface-400",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[T(s.type),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${H(s.status||"")}`,children:s.status}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${R(s.criticality||"")}`}),e.jsxs("span",{className:"text-surface-400 capitalize text-sm",children:[s.criticality," criticality"]})]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{variant:"secondary",onClick:()=>i(!0),leftIcon:e.jsx($,{className:"w-4 h-4"}),children:"Edit"}),e.jsx(y,{variant:"danger",onClick:()=>f(!0),leftIcon:e.jsx(q,{className:"w-4 h-4"}),children:"Delete"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-surface-800 rounded-xl border border-surface-700 p-6 space-y-6",children:[s.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Description"}),e.jsx("p",{className:"text-surface-200",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Type"}),e.jsx("p",{className:"text-white capitalize",children:s.type})]}),s.category&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Category"}),e.jsx("p",{className:"text-white",children:s.category})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Source"}),e.jsx("p",{className:"text-white capitalize",children:s.source})]}),s.externalId&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"External ID"}),e.jsx("p",{className:"text-white font-mono text-sm",children:s.externalId})]}),s.owner&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Owner"}),e.jsx("p",{className:"text-white",children:s.owner})]}),s.department&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Department"}),e.jsx("p",{className:"text-white",children:s.department})]}),s.location&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Location"}),e.jsx("p",{className:"text-white",children:s.location})]}),s.lastSyncAt&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-2",children:"Last Synced"}),e.jsx("p",{className:"text-white",children:new Date(s.lastSyncAt).toLocaleString()})]})]}),s.metadata&&Object.keys(s.metadata).length>0&&e.jsxs("div",{className:"border-t border-surface-700 pt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-surface-400 mb-3",children:"Additional Metadata"}),e.jsx("div",{className:"bg-surface-700/50 rounded-lg p-4",children:e.jsx("pre",{className:"text-sm text-surface-300 overflow-x-auto",children:JSON.stringify(s.metadata,null,2)})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Risk Summary"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-surface-400 flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Associated Risks"]}),e.jsx("span",{className:`px-2 py-1 rounded text-sm ${(s.riskCount??0)>0?"bg-red-500/20 text-red-400":"text-white"}`,children:s.riskCount??0})]})})]}),e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Timeline"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Created"}),e.jsx("span",{className:"text-surface-200",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Updated"}),e.jsx("span",{className:"text-surface-200",children:new Date(s.updatedAt).toLocaleDateString()})]})]})]})]})]}),s.risks&&s.risks.length>0&&e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Associated Risks"}),e.jsx("div",{className:"space-y-2",children:s.risks.map(t=>e.jsxs("div",{onClick:()=>o(`/risks/${t.id}`),className:"flex items-center justify-between p-4 bg-surface-700 rounded-lg cursor-pointer hover:bg-surface-600 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-brand-400 font-mono text-sm",children:t.riskId}),e.jsx("span",{className:"text-white",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${_(t.inherentRisk)}`}),e.jsx("span",{className:"text-surface-400 capitalize text-sm",children:t.inherentRisk})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="mitigated"?"bg-emerald-500/20 text-emerald-400":t.status==="in_treatment"?"bg-amber-500/20 text-amber-400":"bg-red-500/20 text-red-400"}`,children:t.status.replace("_"," ")})]})]},t.id))})]}),e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-brand-400"}),"Business Continuity / Disaster Recovery"]}),e.jsx(j,{to:"/bcdr",className:"text-brand-400 text-sm hover:text-brand-300",children:"View BC/DR Dashboard →"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-surface-400 mb-2 flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),"RTO (Recovery Time)"]}),e.jsx("p",{className:"text-white text-lg font-semibold",children:s.rtoHours?`${s.rtoHours} hours`:"Not set"})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-surface-400 mb-2 flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),"RPO (Recovery Point)"]}),e.jsx("p",{className:"text-white text-lg font-semibold",children:s.rpoHours?`${s.rpoHours} hours`:"Not set"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-surface-400 mb-2",children:"BC/DR Criticality"}),e.jsx("p",{className:"text-white",children:s.bcdrCriticality?e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.bcdrCriticality==="tier_1_critical"?"bg-red-500/20 text-red-400":s.bcdrCriticality==="tier_2_essential"?"bg-orange-500/20 text-orange-400":s.bcdrCriticality==="tier_3_important"?"bg-yellow-500/20 text-yellow-400":"bg-blue-500/20 text-blue-400"}`,children:s.bcdrCriticality.replace(/_/g," ")}):"Not set"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-surface-400 mb-2",children:"Recovery Strategy"}),e.jsx("p",{className:"text-white",children:s.recoveryStrategyId?e.jsx(j,{to:`/bcdr/strategies/${s.recoveryStrategyId}`,className:"text-brand-400 hover:text-brand-300",children:"View Strategy →"}):e.jsx("span",{className:"text-surface-500",children:"Not assigned"})})]})]}),s.recoveryNotes&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-surface-700",children:[e.jsx("h4",{className:"text-sm font-medium text-surface-400 mb-2",children:"Recovery Notes"}),e.jsx("p",{className:"text-surface-200 text-sm",children:s.recoveryNotes})]})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-surface-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Edit Asset"}),e.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-surface-700 rounded-lg text-surface-400",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),m.mutate(r)},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:t=>l(a=>({...a,name:t.target.value})),required:!0,className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Type *"}),e.jsx("select",{value:r.type,onChange:t=>l(a=>({...a,type:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",children:C.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Status"}),e.jsx("select",{value:r.status,onChange:t=>l(a=>({...a,status:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",children:Y.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Criticality"}),e.jsx("select",{value:r.criticality,onChange:t=>l(a=>({...a,criticality:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",children:S.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Category"}),e.jsx("input",{type:"text",value:r.category,onChange:t=>l(a=>({...a,category:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",placeholder:"e.g., Web Server"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Owner"}),e.jsx("input",{type:"text",value:r.owner,onChange:t=>l(a=>({...a,owner:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:r.department,onChange:t=>l(a=>({...a,department:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Location"}),e.jsx("input",{type:"text",value:r.location,onChange:t=>l(a=>({...a,location:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",placeholder:"e.g., AWS us-east-1, Office HQ"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>l(a=>({...a,description:t.target.value})),rows:3,className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",placeholder:"Describe this asset..."})]}),e.jsxs("div",{className:"border-t border-surface-700 pt-4 mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-surface-200 mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4 text-brand-400"}),"Business Continuity / Disaster Recovery"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"RTO (Hours)"}),e.jsx("input",{type:"number",min:"0",value:r.rtoHours??"",onChange:t=>l(a=>({...a,rtoHours:t.target.value?parseInt(t.target.value):void 0})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",placeholder:"e.g., 4"}),e.jsx("p",{className:"text-xs text-surface-500 mt-1",children:"Recovery Time Objective"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"RPO (Hours)"}),e.jsx("input",{type:"number",min:"0",value:r.rpoHours??"",onChange:t=>l(a=>({...a,rpoHours:t.target.value?parseInt(t.target.value):void 0})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",placeholder:"e.g., 1"}),e.jsx("p",{className:"text-xs text-surface-500 mt-1",children:"Recovery Point Objective"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mt-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"BC/DR Criticality"}),e.jsxs("select",{value:r.bcdrCriticality,onChange:t=>l(a=>({...a,bcdrCriticality:t.target.value})),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Not set"}),e.jsx("option",{value:"tier_1_critical",children:"Tier 1 - Critical"}),e.jsx("option",{value:"tier_2_essential",children:"Tier 2 - Essential"}),e.jsx("option",{value:"tier_3_important",children:"Tier 3 - Important"}),e.jsx("option",{value:"tier_4_standard",children:"Tier 4 - Standard"})]})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Recovery Notes"}),e.jsx("textarea",{value:r.recoveryNotes,onChange:t=>l(a=>({...a,recoveryNotes:t.target.value})),rows:2,className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",placeholder:"Notes about recovery procedures for this asset..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-surface-700",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 bg-surface-700 text-surface-300 rounded-lg hover:bg-surface-600",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m.isPending,className:"px-4 py-2 bg-brand-500 text-white rounded-lg hover:bg-brand-600 disabled:opacity-50",children:m.isPending?"Saving...":"Save Changes"})]})]})]})}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Delete Asset"}),e.jsxs("p",{className:"text-surface-400 mb-6",children:['Are you sure you want to delete "',s.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-surface-700 text-surface-300 rounded-lg hover:bg-surface-600",children:"Cancel"}),e.jsx("button",{onClick:()=>u.mutate(),disabled:u.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:u.isPending?"Deleting...":"Delete"})]})]})})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-surface-400",children:"Asset not found"})})}export{te as default};
