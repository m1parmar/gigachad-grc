import{aS as H,u as L,r as p,b as _,c as M,j as e,L as Q,aO as V,B as j,m as O,N as G,M as B,aE as J,aD as D,aN as T,aM as W,v as X,S as Y,V as Z,am as ee,aC as se,aX as ae,aF as te,w as le}from"./vendor-CWk44mA8.js";import{f as S,o as re,m as ne}from"./index-CiJwl-Bo.js";import{C as ce,T as ie}from"./TasksPanel-lJoOjrDO.js";import{b as de,c as K}from"./Skeleton-DVOICtGK.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const oe={compliant:{icon:Y,color:"text-green-400",bg:"bg-green-400/10"},partial:{icon:X,color:"text-yellow-400",bg:"bg-yellow-400/10"},non_compliant:{icon:W,color:"text-red-400",bg:"bg-red-400/10"},not_applicable:{icon:T,color:"text-surface-400",bg:"bg-surface-400/10"},not_assessed:{icon:T,color:"text-surface-500",bg:"bg-surface-500/10"}};function ge(){const{id:s}=H(),i=L(),[o,n]=p.useState(new Set),[x,d]=p.useState(null),[c,u]=p.useState(!1),[v,b]=p.useState(!1),[f,g]=p.useState(null),[l,h]=p.useState("all"),[t,N]=p.useState({reference:"",title:"",description:"",guidance:"",isCategory:!1}),{data:y,isLoading:U}=_({queryKey:["framework",s],queryFn:()=>S.get(s).then(a=>a.data),enabled:!!s}),{data:m,isLoading:P}=_({queryKey:["framework-readiness",s],queryFn:()=>S.getReadiness(s).then(a=>a.data),enabled:!!s}),{data:w}=_({queryKey:["framework-requirements",s],queryFn:()=>S.getRequirementTree(s).then(a=>a.data),enabled:!!s}),R=M({mutationFn:a=>S.createRequirement(s,a),onSuccess:()=>{i.invalidateQueries({queryKey:["framework-requirements",s]}),i.invalidateQueries({queryKey:["framework-readiness",s]}),u(!1),N({reference:"",title:"",description:"",guidance:"",isCategory:!1}),D.success("Requirement created successfully")},onError:()=>{D.error("Failed to create requirement")}}),C=M({mutationFn:a=>S.bulkUploadRequirements(s,a),onSuccess:a=>{i.invalidateQueries({queryKey:["framework-requirements",s]}),i.invalidateQueries({queryKey:["framework-readiness",s]}),b(!1),g(null);const E=a.data?.count||0;D.success(`Successfully uploaded ${E} requirements`)},onError:a=>{D.error(a?.response?.data?.message||"Failed to upload file")}}),F=a=>{a.preventDefault(),R.mutate(t)},k=()=>{f&&C.mutate(f)},r=a=>{n(E=>{const A=new Set(E);return A.has(a)?A.delete(a):A.add(a),A})};if(U||P)return e.jsxs("div",{className:"space-y-6",children:[e.jsx(de,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsx("div",{children:e.jsx(K,{})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(K,{})})]}),e.jsx(K,{})]});if(!y)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-surface-400",children:"Framework not found"})});const q=m?.score||0,I=q>=80?"text-green-400":q>=50?"text-yellow-400":"text-red-400";return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsxs(Q,{to:"/frameworks",className:"inline-flex items-center text-sm text-surface-400 hover:text-surface-100 mb-4",children:[e.jsx(V,{className:"w-4 h-4 mr-1"}),"Back to Frameworks"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-surface-100",children:y.name}),e.jsx("p",{className:"text-surface-400 mt-1",children:y.description})]}),e.jsx("span",{className:"badge badge-info text-sm uppercase",children:y.type})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-6 lg:col-span-1",children:[e.jsx("p",{className:"text-sm text-surface-400 mb-2",children:"Readiness Score"}),e.jsxs("p",{className:j("text-5xl font-bold",I),children:[q,"%"]}),e.jsx("div",{className:"progress-bar mt-4",children:e.jsx("div",{className:j("progress-fill",q>=80?"bg-green-500":q>=50?"bg-yellow-500":"bg-red-500"),style:{width:`${q}%`}})})]}),e.jsxs("div",{className:"card p-6 lg:col-span-3",children:[e.jsx("p",{className:"text-sm text-surface-400 mb-4",children:"Requirements by Status (click to filter)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:m?.requirementsByStatus&&e.jsxs(e.Fragment,{children:[e.jsx($,{label:"Compliant",value:m.requirementsByStatus.compliant,status:"compliant",isActive:l==="compliant",onClick:()=>h(l==="compliant"?"all":"compliant")}),e.jsx($,{label:"Partial",value:m.requirementsByStatus.partial,status:"partial",isActive:l==="partial",onClick:()=>h(l==="partial"?"all":"partial")}),e.jsx($,{label:"Non-Compliant",value:m.requirementsByStatus.non_compliant,status:"non_compliant",isActive:l==="non_compliant",onClick:()=>h(l==="non_compliant"?"all":"non_compliant")}),e.jsx($,{label:"N/A",value:m.requirementsByStatus.not_applicable,status:"not_applicable",isActive:l==="not_applicable",onClick:()=>h(l==="not_applicable"?"all":"not_applicable")}),e.jsx($,{label:"Not Assessed",value:m.requirementsByStatus.not_assessed,status:"not_assessed",isActive:l==="not_assessed",onClick:()=>h(l==="not_assessed"?"all":"not_assessed")})]})}),l!=="all"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm mt-4 pt-4 border-t border-surface-800",children:[e.jsx("span",{className:"text-surface-400",children:"Filtering by:"}),e.jsxs("span",{className:j("px-2 py-1 rounded-full text-xs font-medium",l==="compliant"&&"bg-green-400/20 text-green-400",l==="partial"&&"bg-yellow-400/20 text-yellow-400",l==="non_compliant"&&"bg-red-400/20 text-red-400",l==="not_applicable"&&"bg-surface-400/20 text-surface-400",l==="not_assessed"&&"bg-surface-500/20 text-surface-500"),children:[l==="compliant"&&"Compliant",l==="partial"&&"Partial",l==="non_compliant"&&"Non-Compliant",l==="not_applicable"&&"Not Applicable",l==="not_assessed"&&"Not Assessed"]}),e.jsx("button",{onClick:()=>h("all"),className:"text-surface-400 hover:text-surface-100 ml-2",children:e.jsx(O,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:j("card",x?"lg:col-span-2":"lg:col-span-3"),children:[e.jsxs("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-surface-100",children:"Requirements"}),e.jsx("p",{className:"text-sm text-surface-400 mt-1",children:w&&w.length>0?"Click on any requirement to view details":"Add requirements to define compliance criteria"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>b(!0),className:"btn-secondary text-sm",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"Bulk Upload"]}),e.jsxs("button",{onClick:()=>u(!0),className:"btn-primary text-sm",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Add Requirement"]})]})]}),e.jsx("div",{className:"divide-y divide-surface-800 max-h-[600px] overflow-y-auto",children:w&&w.length>0?w.map(a=>e.jsx(z,{requirement:a,level:0,expanded:o,onToggle:r,onSelect:d,selectedId:x?.id,statusFilter:l},a.id)):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("p",{className:"text-surface-400 mb-4",children:"No requirements yet"}),e.jsxs("button",{onClick:()=>u(!0),className:"btn-secondary text-sm",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Add Your First Requirement"]})]})})]}),x&&e.jsx(xe,{requirement:x,frameworkId:s,onClose:()=>d(null)})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-surface-100",children:"Add Requirement"}),e.jsx("button",{onClick:()=>u(!1),className:"text-surface-400 hover:text-surface-200",children:e.jsx(O,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Reference *"}),e.jsx("input",{type:"text",required:!0,value:t.reference,onChange:a=>N({...t,reference:a.target.value}),placeholder:"e.g., CC1.1, A.5.1.1",className:"input w-full"}),e.jsx("p",{className:"text-xs text-surface-500 mt-1",children:"Unique identifier for this requirement"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.isCategory,onChange:a=>N({...t,isCategory:a.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-surface-300",children:"This is a category"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:t.title,onChange:a=>N({...t,title:a.target.value}),placeholder:"Brief title for the requirement",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Description *"}),e.jsx("textarea",{required:!0,value:t.description,onChange:a=>N({...t,description:a.target.value}),placeholder:"What does this requirement entail?",rows:3,className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Guidance (Optional)"}),e.jsx("textarea",{value:t.guidance,onChange:a=>N({...t,guidance:a.target.value}),placeholder:"Additional implementation guidance...",rows:3,className:"input w-full"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:R.isPending,className:"btn-primary flex-1",children:R.isPending?"Creating...":"Create Requirement"})]})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-lg p-6 w-full max-w-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-surface-100",children:"Bulk Upload Requirements"}),e.jsx("button",{onClick:()=>{b(!1),g(null)},className:"text-surface-400 hover:text-surface-200",children:e.jsx(O,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-surface-800/50 rounded-lg border border-surface-700",children:[e.jsx("p",{className:"text-sm text-surface-300 mb-2",children:"Upload a CSV, Excel (.xlsx, .xls), or JSON file with the following columns:"}),e.jsxs("ul",{className:"text-xs text-surface-400 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"reference"})," - Unique identifier (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"title"})," - Requirement title (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"description"})," - Detailed description (required)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"guidance"})," - Implementation guidance (optional)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"isCategory"})," - true/false (optional)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"order"})," - Display order number (optional)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium text-surface-300",children:"level"})," - Hierarchy level 0-3 (optional)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Select File"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls,.json",onChange:a=>g(a.target.files?.[0]||null),className:`block w-full text-sm text-surface-300
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-lg file:border-0
                      file:text-sm file:font-medium
                      file:bg-brand-600 file:text-white
                      hover:file:bg-brand-700
                      file:cursor-pointer cursor-pointer`})}),f&&e.jsxs("p",{className:"text-xs text-surface-400 mt-2",children:["Selected: ",f.name," (",(f.size/1024).toFixed(1)," KB)"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-brand-400"}),e.jsx("span",{className:"text-surface-400",children:"Templates:"})]}),e.jsx("a",{href:"/templates/requirements-template.csv",download:!0,className:"text-brand-400 hover:text-brand-300 underline",children:"CSV"}),e.jsx("a",{href:"/templates/requirements-template.json",download:!0,className:"text-brand-400 hover:text-brand-300 underline",children:"JSON"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{b(!1),g(null)},className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:k,disabled:!f||C.isPending,className:"btn-primary flex-1",children:C.isPending?"Uploading...":"Upload"})]})]})]})})]})}function $({label:s,value:i,status:o,isActive:n,onClick:x}){const d=oe[o],c=d.icon;return e.jsxs("button",{onClick:x,className:j("p-3 rounded-lg text-left transition-all w-full",d.bg,n?"ring-2 ring-offset-1 ring-offset-surface-900":"hover:opacity-80 cursor-pointer",n&&o==="compliant"&&"ring-green-400",n&&o==="partial"&&"ring-yellow-400",n&&o==="non_compliant"&&"ring-red-400",n&&o==="not_applicable"&&"ring-surface-400",n&&o==="not_assessed"&&"ring-surface-500"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:j("w-4 h-4",d.color)}),e.jsx("span",{className:j("text-xl font-bold",d.color),children:i})]}),e.jsx("p",{className:"text-xs text-surface-400 mt-1",children:s}),n&&e.jsx("p",{className:j("text-xs mt-1",d.color),children:"Click to clear"})]})}function z({requirement:s,level:i,expanded:o,onToggle:n,onSelect:x,selectedId:d,statusFilter:c}){const u=s.children?.length>0,v=o.has(s.id),b=d===s.id,f=s.isCategory?"category":s.complianceStatus||"not_assessed",g=t=>!c||c==="all"||(t.isCategory?"category":t.complianceStatus||"not_assessed")===c?!0:t.children?.length>0?t.children.some(y=>g(y)):!1;if(c&&c!=="all"&&!g(s))return null;const l=t=>{t.stopPropagation(),u&&n(s.id),x(s)},h=c&&c!=="all"&&f===c;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:j("flex items-center gap-3 p-4 transition-colors cursor-pointer",b?"bg-brand-500/20 border-l-2 border-brand-500":"hover:bg-surface-800/50",h&&!b&&"bg-surface-700/30"),style:{paddingLeft:`${i*24+16}px`},onClick:l,children:[u?e.jsx("button",{className:"p-1 -ml-1",onClick:t=>{t.stopPropagation(),n(s.id)},children:v?e.jsx(Z,{className:"w-4 h-4 text-surface-400"}):e.jsx(ee,{className:"w-4 h-4 text-surface-400"})}):e.jsx("div",{className:"w-6"}),e.jsx("span",{className:"font-mono text-sm text-brand-400 w-20 flex-shrink-0",children:s.reference}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-surface-100 truncate",children:s.title}),!s.isCategory&&s.mappings?.length>0&&e.jsxs("p",{className:"text-xs text-surface-500 mt-1",children:[s.mappings.length," control(s) mapped"]})]}),s.isCategory?e.jsx("span",{className:"badge badge-neutral text-xs",children:"Category"}):e.jsxs("span",{className:"badge badge-neutral text-xs",children:[s.mappings?.length||0," controls"]})]}),u&&v&&e.jsx(e.Fragment,{children:s.children.map(t=>e.jsx(z,{requirement:t,level:i+1,expanded:o,onToggle:n,onSelect:x,selectedId:d,statusFilter:c},t.id))})]})}function xe({requirement:s,frameworkId:i,onClose:o}){const n=L(),[x,d]=p.useState(!1),[c,u]=p.useState(s.ownerId||""),[v,b]=p.useState(s.ownerNotes||""),[f,g]=p.useState(s.dueDate?s.dueDate.split("T")[0]:""),[l,h]=p.useState(s.priority||""),{data:t,isLoading:N}=_({queryKey:["requirement-mappings",s.id],queryFn:()=>re.byRequirement(s.id).then(r=>r.data),enabled:!!s.id&&!s.isCategory}),{data:y}=_({queryKey:["users"],queryFn:()=>ne.list().then(r=>r.data)}),U=y?.data||[],{data:m}=_({queryKey:["requirement-detail",i,s.id],queryFn:()=>S.getRequirement(i,s.id).then(r=>r.data),enabled:!!s.id}),P=M({mutationFn:r=>S.updateRequirement(i,s.id,r),onSuccess:()=>{D.success("Requirement updated"),n.invalidateQueries({queryKey:["requirement-detail",i,s.id]}),n.invalidateQueries({queryKey:["framework-requirements",i]}),d(!1)},onError:()=>{D.error("Failed to update requirement")}}),w=()=>{P.mutate({ownerId:c||null,ownerNotes:v,dueDate:f||null,priority:l||null})},R=m?.owner||s.owner,C=m?.ownerNotes||s.ownerNotes,F=m?.dueDate||s.dueDate,k=m?.priority||s.priority;return e.jsxs("div",{className:"card lg:col-span-1 h-fit sticky top-4",children:[e.jsxs("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-surface-100",children:"Requirement Details"}),e.jsx("button",{onClick:o,className:"p-1 hover:bg-surface-700 rounded transition-colors",children:e.jsx(O,{className:"w-5 h-5 text-surface-400"})})]}),e.jsxs("div",{className:"p-4 space-y-4 max-h-[calc(100vh-200px)] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm text-brand-400 bg-brand-500/10 px-2 py-1 rounded",children:s.reference}),e.jsx("h4",{className:"text-lg font-medium text-surface-100 mt-2",children:s.title})]}),s.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-surface-500 uppercase tracking-wide mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-surface-300 leading-relaxed line-clamp-4",children:s.description})]}),!s.isCategory&&e.jsxs("div",{className:"border-t border-surface-800 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-xs text-surface-500 uppercase tracking-wide",children:"Assignment"}),x?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(!1),className:"text-xs text-surface-400 hover:text-surface-300",children:"Cancel"}),e.jsx("button",{onClick:w,disabled:P.isPending,className:"text-xs text-green-400 hover:text-green-300",children:P.isPending?"Saving...":"Save"})]}):e.jsx("button",{onClick:()=>{u(R?.id||""),b(C||""),g(F?F.split("T")[0]:""),h(k||""),d(!0)},className:"text-xs text-brand-400 hover:text-brand-300",children:"Edit"})]}),x?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-surface-400 mb-1",children:"Owner"}),e.jsxs("select",{value:c,onChange:r=>u(r.target.value),className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-sm text-surface-100 focus:outline-none focus:border-brand-500",children:[e.jsx("option",{value:"",children:"Unassigned"}),U?.map(r=>e.jsxs("option",{value:r.id,children:[r.displayName," (",r.role,")"]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-surface-400 mb-1",children:"Priority"}),e.jsxs("select",{value:l,onChange:r=>h(r.target.value),className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-sm text-surface-100 focus:outline-none focus:border-brand-500",children:[e.jsx("option",{value:"",children:"Not Set"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-surface-400 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:f,onChange:r=>g(r.target.value),className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-sm text-surface-100 focus:outline-none focus:border-brand-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-surface-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:v,onChange:r=>b(r.target.value),rows:3,placeholder:"Add notes about this requirement...",className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-sm text-surface-100 focus:outline-none focus:border-brand-500 resize-none"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-surface-800/50 rounded-lg",children:[e.jsx(se,{className:"w-4 h-4 text-surface-500"}),e.jsx("span",{className:"text-sm text-surface-300",children:R?.displayName||"Unassigned"})]}),k&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-surface-800/50 rounded-lg",children:[e.jsx(ae,{className:j("w-4 h-4",k==="high"?"text-red-400":k==="medium"?"text-yellow-400":"text-green-400")}),e.jsxs("span",{className:"text-sm text-surface-300 capitalize",children:[k," Priority"]})]}),F&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-surface-800/50 rounded-lg",children:[e.jsx(te,{className:"w-4 h-4 text-surface-500"}),e.jsxs("span",{className:"text-sm text-surface-300",children:["Due: ",new Date(F).toLocaleDateString()]})]}),C&&e.jsxs("div",{className:"p-2 bg-surface-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-surface-500 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-surface-300",children:C})]})]})]}),!s.isCategory&&e.jsxs("div",{className:"border-t border-surface-800 pt-4",children:[e.jsxs("p",{className:"text-xs text-surface-500 uppercase tracking-wide mb-2",children:["Mapped Controls (",t?.length||0,")"]}),N?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-surface-700 rounded-full border-t-brand-500"})}):t&&t.length>0?e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:t.map(r=>e.jsx(Q,{to:`/controls/${r.control?.id}`,className:"block p-3 bg-surface-800/50 rounded-lg hover:bg-surface-800 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-brand-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-mono text-brand-400",children:r.control?.controlId}),e.jsx("p",{className:"text-sm text-surface-200 truncate",children:r.control?.title})]})]})},r.id))}):e.jsx("p",{className:"text-sm text-surface-500 italic",children:"No controls mapped yet"})]}),s.isCategory&&s.children?.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-surface-500 uppercase tracking-wide mb-1",children:"Sub-requirements"}),e.jsxs("p",{className:"text-sm text-surface-300",children:[s.children.length," child requirement(s)"]})]}),!s.isCategory&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t border-surface-800 pt-4",children:e.jsx(ce,{entityType:"requirement",entityId:s.id})}),e.jsx("div",{className:"border-t border-surface-800 pt-4",children:e.jsx(ie,{entityType:"requirement",entityId:s.id})})]})]})]})}export{ge as default};
