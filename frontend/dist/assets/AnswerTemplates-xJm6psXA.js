import{u as D,r as d,b as I,c as j,j as e,M,l as Q,a3 as U,B as w,ad as z,aa as K,a$ as L,m as R,aQ as V,bC as _,h as B,aD as i}from"./vendor-CWk44mA8.js";import{b as G,B as b,F as h}from"./index-CiJwl-Bo.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const C=[{value:"security",label:"Security",color:"bg-red-500/20 text-red-400"},{value:"privacy",label:"Privacy",color:"bg-purple-500/20 text-purple-400"},{value:"compliance",label:"Compliance",color:"bg-blue-500/20 text-blue-400"},{value:"legal",label:"Legal",color:"bg-amber-500/20 text-amber-400"},{value:"technical",label:"Technical",color:"bg-green-500/20 text-green-400"},{value:"general",label:"General",color:"bg-surface-500/20 text-surface-400"}];function X(){const{user:o}=G(),u=D(),x=o?.organizationId||"default-org",[p,v]=d.useState(""),[l,m]=d.useState(""),[g,f]=d.useState(!1),[y,a]=d.useState(!1),[r,n]=d.useState(null),[t,N]=d.useState(null),{data:S,isLoading:E}=I({queryKey:["answer-templates",x,l,g,p],queryFn:async()=>(await h.list({organizationId:x,category:l||void 0,status:g?"archived":"active",search:p||void 0})).data}),T=j({mutationFn:async s=>(await h.create(s)).data,onSuccess:()=>{u.invalidateQueries({queryKey:["answer-templates"]}),i.success("Template created successfully"),a(!1),n(null)},onError:()=>{i.error("Failed to create template")}}),k=j({mutationFn:async({id:s,data:c})=>(await h.update(s,c)).data,onSuccess:()=>{u.invalidateQueries({queryKey:["answer-templates"]}),i.success("Template updated successfully"),a(!1),n(null)},onError:()=>{i.error("Failed to update template")}}),$=j({mutationFn:async s=>{await h.delete(s)},onSuccess:()=>{u.invalidateQueries({queryKey:["answer-templates"]}),i.success("Template deleted"),N(null)},onError:()=>{i.error("Failed to delete template")}}),q=j({mutationFn:async s=>(await h.archive(s)).data,onSuccess:()=>{u.invalidateQueries({queryKey:["answer-templates"]}),i.success("Template archived")}}),F=s=>C.find(A=>A.value===s)?.color||"bg-surface-700 text-surface-300";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-surface-100",children:"Answer Templates"}),e.jsx("p",{className:"mt-1 text-surface-400",children:"Create and manage reusable answer templates for questionnaires"})]}),e.jsx(b,{onClick:()=>{n(null),a(!0)},leftIcon:e.jsx(M,{className:"w-5 h-5"}),children:"New Template"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-surface-400"}),e.jsx("input",{type:"text",value:p,onChange:s=>v(s.target.value),placeholder:"Search templates...",className:"w-full pl-10 pr-4 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:border-brand-500"})]}),e.jsxs("select",{value:l,onChange:s=>m(s.target.value),className:"px-4 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:border-brand-500",children:[e.jsx("option",{value:"",children:"All Categories"}),C.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-surface-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:s=>f(s.target.checked),className:"rounded border-surface-600 text-brand-500"}),"Show Archived"]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:E?Array.from({length:6}).map((s,c)=>e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-5 animate-pulse",children:[e.jsx("div",{className:"h-5 bg-surface-700 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-16 bg-surface-800 rounded mb-3"}),e.jsx("div",{className:"h-4 bg-surface-700 rounded w-1/2"})]},c)):S?.length===0?e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(U,{className:"w-12 h-12 text-surface-600 mx-auto mb-3"}),e.jsx("p",{className:"text-surface-400",children:"No templates found"}),e.jsx("p",{className:"text-sm text-surface-500 mt-1",children:"Create your first template to get started"})]}):S?.map(s=>e.jsxs("div",{className:w("bg-surface-900 border rounded-xl p-5 cursor-pointer transition-all hover:border-surface-600",t?.id===s.id?"border-brand-500 ring-2 ring-brand-500/20":"border-surface-800"),onClick:()=>N(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-surface-100 truncate flex-1",children:s.title}),e.jsx("span",{className:w("px-2 py-0.5 text-xs rounded-full ml-2",F(s.category)),children:s.category||"General"})]}),e.jsx("p",{className:"text-sm text-surface-400 line-clamp-3 mb-4",children:s.content}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-surface-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.variables.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3.5 h-3.5"}),s.variables.length," vars"]}),s.usageCount>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-3.5 h-3.5"}),"Used ",s.usageCount,"x"]})]}),s.tags.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3.5 h-3.5"}),s.tags.length]})]})]},s.id))}),t&&e.jsxs("div",{className:"fixed inset-y-0 right-0 w-full max-w-lg bg-surface-900 border-l border-surface-700 shadow-xl z-40 overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-surface-900 border-b border-surface-700 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-surface-100",children:"Template Details"}),e.jsx("button",{onClick:()=>N(null),className:"p-2 text-surface-400 hover:text-surface-200 rounded-lg hover:bg-surface-800",children:e.jsx(R,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-surface-100",children:t.title}),e.jsx("span",{className:w("px-2 py-1 text-xs rounded-full",F(t.category)),children:t.category||"General"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-400 mb-2",children:"Content"}),e.jsx("div",{className:"bg-surface-800 rounded-lg p-4 text-sm text-surface-200 whitespace-pre-wrap font-mono",children:t.content})]}),t.variables.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-surface-400 mb-2",children:["Variables (",t.variables.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.variables.map((s,c)=>e.jsx("span",{className:"px-2 py-1 bg-brand-500/20 text-brand-400 text-xs rounded font-mono",children:`{{${s}}}`},c))})]}),t.tags.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-400 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((s,c)=>e.jsx("span",{className:"px-2 py-1 bg-surface-700 text-surface-300 text-xs rounded",children:s},c))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-surface-500",children:"Usage Count"}),e.jsx("p",{className:"text-surface-200",children:t.usageCount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-surface-500",children:"Last Used"}),e.jsx("p",{className:"text-surface-200",children:t.lastUsedAt?new Date(t.lastUsedAt).toLocaleDateString():"Never"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-surface-700",children:[e.jsx(b,{variant:"outline",onClick:()=>{n(t),a(!0)},leftIcon:e.jsx(V,{className:"w-4 h-4"}),className:"flex-1",children:"Edit"}),e.jsx(b,{variant:"outline",onClick:()=>q.mutate(t.id),leftIcon:e.jsx(_,{className:"w-4 h-4"}),children:"Archive"}),e.jsx(b,{variant:"danger",onClick:()=>{confirm("Are you sure you want to delete this template?")&&$.mutate(t.id)},leftIcon:e.jsx(B,{className:"w-4 h-4"}),children:"Delete"})]})]})]}),y&&e.jsx(O,{template:r,organizationId:x,onClose:()=>{a(!1),n(null)},onSave:s=>{r?k.mutate({id:r.id,data:s}):T.mutate(s)},isLoading:T.isPending||k.isPending})]})}function O({template:o,organizationId:u,onClose:x,onSave:p,isLoading:v}){const[l,m]=d.useState({title:o?.title||"",content:o?.content||"",category:o?.category||"",tags:o?.tags?.join(", ")||""}),f=(a=>{const r=/\{\{(\w+)\}\}/g,n=[];let t;for(;(t=r.exec(a))!==null;)n.includes(t[1])||n.push(t[1]);return n})(l.content),y=a=>{a.preventDefault(),p({organizationId:u,title:l.title,content:l.content,category:l.category||void 0,tags:l.tags.split(",").map(r=>r.trim()).filter(Boolean),variables:f})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface-900 border border-surface-700 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-surface-900 border-b border-surface-700 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-surface-100",children:o?"Edit Template":"Create Template"}),e.jsx("button",{onClick:x,className:"p-2 text-surface-400 hover:text-surface-200 rounded-lg hover:bg-surface-800",children:e.jsx(R,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:y,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-surface-400 mb-1",children:["Title ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:l.title,onChange:a=>m(r=>({...r,title:a.target.value})),className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:border-brand-500",placeholder:"e.g., SOC 2 Compliance Response"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-400 mb-1",children:"Category"}),e.jsxs("select",{value:l.category,onChange:a=>m(r=>({...r,category:a.target.value})),className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:border-brand-500",children:[e.jsx("option",{value:"",children:"Select category..."}),C.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-surface-400 mb-1",children:["Content ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("p",{className:"text-xs text-surface-500 mb-2",children:["Use ","{{variable_name}}"," for placeholders that will be replaced when using the template."]}),e.jsx("textarea",{required:!0,value:l.content,onChange:a=>m(r=>({...r,content:a.target.value})),rows:8,className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:border-brand-500 font-mono text-sm",placeholder:`Enter template content...

Example:
{{company_name}} maintains SOC 2 Type II compliance. Our last audit was completed on {{audit_date}} by {{auditor_name}}.`})]}),f.length>0&&e.jsxs("div",{className:"p-3 bg-brand-500/10 border border-brand-500/30 rounded-lg",children:[e.jsxs("label",{className:"block text-sm font-medium text-brand-400 mb-2",children:["Detected Variables (",f.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:f.map((a,r)=>e.jsx("span",{className:"px-2 py-1 bg-brand-500/20 text-brand-300 text-xs rounded font-mono",children:`{{${a}}}`},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-400 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:l.tags,onChange:a=>m(r=>({...r,tags:a.target.value})),className:"w-full px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:border-brand-500",placeholder:"encryption, data-protection, audit (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-surface-700",children:[e.jsx(b,{variant:"secondary",type:"button",onClick:x,children:"Cancel"}),e.jsx(b,{type:"submit",isLoading:v,children:o?"Save Changes":"Create Template"})]})]})]})})}export{X as default};
