import{u as P,r as m,b as v,c as h,j as e,M as O,c2 as b,S as u,bT as w,g as j,ay as C,cd as q,aP as E,h as K,aa as S}from"./vendor-CWk44mA8.js";import{W as n}from"./index-CiJwl-Bo.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";function Q(){const c=P(),[A,x]=m.useState(!1),[s,o]=m.useState(null),[d,l]=m.useState({}),[r,k]=m.useState(null),{data:T,isLoading:_}=v({queryKey:["mcp-servers"],queryFn:()=>n.getServers()}),{data:I}=v({queryKey:["mcp-templates"],queryFn:()=>n.getTemplates()}),i=T?.data?.data||[],R=I?.data?.data||[],L=h({mutationFn:a=>n.connectServer(a),onSuccess:()=>c.invalidateQueries({queryKey:["mcp-servers"]})}),F=h({mutationFn:a=>n.disconnectServer(a),onSuccess:()=>c.invalidateQueries({queryKey:["mcp-servers"]})}),M=h({mutationFn:a=>n.deleteServer(a),onSuccess:()=>c.invalidateQueries({queryKey:["mcp-servers"]})}),p=h({mutationFn:({templateId:a,env:t})=>n.deployTemplate(a,t),onSuccess:()=>{c.invalidateQueries({queryKey:["mcp-servers"]}),x(!1),o(null),l({})}}),N=a=>{switch(a){case"connected":return e.jsx(u,{className:"w-5 h-5 text-green-500"});case"error":return e.jsx(w,{className:"w-5 h-5 text-red-500"});case"connecting":return e.jsx(C,{className:"w-5 h-5 text-yellow-500 animate-spin"});default:return e.jsx(S,{className:"w-5 h-5 text-gray-500"})}},f=a=>{const t={connected:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",disconnected:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400",connecting:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",error:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t[a]}`,children:a})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"MCP Server Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage Model Context Protocol servers for automated GRC workflows"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"Add Server"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-surface-800 rounded-lg p-4 border border-gray-200 dark:border-surface-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-brand-100 dark:bg-brand-900/30 rounded-lg",children:e.jsx(b,{className:"w-6 h-6 text-brand-600 dark:text-brand-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.length}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Servers"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-surface-800 rounded-lg p-4 border border-gray-200 dark:border-surface-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(u,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.filter(a=>a.status==="connected").length}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Connected"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-surface-800 rounded-lg p-4 border border-gray-200 dark:border-surface-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e.jsx(w,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.filter(a=>a.status==="error").length}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Errors"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-surface-800 rounded-lg p-4 border border-gray-200 dark:border-surface-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.reduce((a,t)=>a+(t.capabilities?.tools?.length||0),0)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Available Tools"})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-surface-800 rounded-lg border border-gray-200 dark:border-surface-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-surface-700",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Registered Servers"})}),_?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(C,{className:"w-8 h-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Loading servers..."})]}):i.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(b,{className:"w-12 h-12 mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"No servers configured"}),e.jsx("button",{onClick:()=>x(!0),className:"mt-4 btn-secondary",children:"Add your first server"})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-surface-700",children:i.map(a=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-surface-700/50 cursor-pointer",onClick:()=>k(a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[N(a.status),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[a.transport," • ",a.id]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[f(a.status),e.jsxs("div",{className:"flex items-center gap-2",children:[a.status==="connected"?e.jsx("button",{onClick:t=>{t.stopPropagation(),F.mutate(a.id)},className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",title:"Disconnect",children:e.jsx(q,{className:"w-5 h-5"})}):e.jsx("button",{onClick:t=>{t.stopPropagation(),L.mutate(a.id)},className:"p-2 text-gray-500 hover:text-green-600 dark:hover:text-green-400",title:"Connect",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),confirm("Are you sure you want to delete this server?")&&M.mutate(a.id)},className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",title:"Delete",children:e.jsx(K,{className:"w-5 h-5"})})]})]})]}),a.lastError&&e.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:a.lastError})]},a.id))})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-surface-800 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-auto",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-surface-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s?`Configure ${s.name}`:"Add MCP Server"}),e.jsx("button",{onClick:()=>{x(!1),o(null),l({})},className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"×"})]}),e.jsx("div",{className:"p-4",children:s?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s.description}),s.configNote&&e.jsx("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:["⚠️ ",s.configNote]})}),s.requiredEnv&&s.requiredEnv.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),"Required Configuration"]}),s.requiredEnv.map(a=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a}),e.jsx("input",{type:"password",value:d[a]||"",onChange:t=>l({...d,[a]:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-surface-600 rounded-lg bg-white dark:bg-surface-700 text-gray-900 dark:text-white",placeholder:`Enter ${a}`})]},a))]}),s.optionalEnv&&s.optionalEnv.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),"Optional Configuration"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure the integrations you want to use. Leave blank to skip."}),s.configGroups?e.jsx("div",{className:"space-y-4",children:s.configGroups.map(a=>e.jsxs("details",{className:"border border-gray-200 dark:border-surface-700 rounded-lg",children:[e.jsxs("summary",{className:"px-4 py-3 cursor-pointer font-medium text-gray-900 dark:text-white bg-gray-50 dark:bg-surface-700/50 rounded-t-lg",children:[a.name,a.keys.some(t=>d[t])&&e.jsx("span",{className:"ml-2 text-xs text-green-600 dark:text-green-400",children:"● Configured"})]}),e.jsx("div",{className:"p-4 space-y-3",children:a.keys.map(t=>{const g=s.optionalEnv?.find(y=>y.key===t);return g?e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[g.label,e.jsxs("span",{className:"ml-2 font-normal text-gray-400 dark:text-gray-500",children:["(",g.description,")"]})]}),e.jsx("input",{type:t.toLowerCase().includes("secret")||t.toLowerCase().includes("password")||t.toLowerCase().includes("token")||t.toLowerCase().includes("key")?"password":"text",value:d[t]||"",onChange:y=>l({...d,[t]:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-surface-600 rounded-lg bg-white dark:bg-surface-700 text-gray-900 dark:text-white",placeholder:g.description})]},t):null})})]},a.name))}):e.jsx("div",{className:"space-y-3",children:s.optionalEnv.map(a=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[a.label,e.jsx("span",{className:"ml-2 font-normal text-gray-400 dark:text-gray-500 text-xs",children:a.description})]}),e.jsx("input",{type:a.key.toLowerCase().includes("secret")||a.key.toLowerCase().includes("password")||a.key.toLowerCase().includes("token")||a.key.toLowerCase().includes("key")?"password":"text",value:d[a.key]||"",onChange:t=>l({...d,[a.key]:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-surface-600 rounded-lg bg-white dark:bg-surface-700 text-gray-900 dark:text-white",placeholder:a.description})]},a.key))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-200 dark:border-surface-700",children:[e.jsx("button",{onClick:()=>o(null),className:"btn-secondary",children:"Back"}),e.jsx("button",{onClick:()=>p.mutate({templateId:s.id,env:Object.fromEntries(Object.entries(d).filter(([a,t])=>t))}),disabled:p.isPending||(s.requiredEnv?.some(a=>!d[a])??!1),className:"btn-primary",children:p.isPending?"Deploying...":"Deploy Server"})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:R.map(a=>e.jsxs("div",{onClick:()=>o(a),className:"p-4 border border-gray-200 dark:border-surface-700 rounded-lg hover:border-brand-500 dark:hover:border-brand-500 cursor-pointer transition-colors",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:a.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.capabilities.map(t=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-surface-700 text-gray-600 dark:text-gray-400 rounded",children:t},t))})]},a.id))})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-surface-800 rounded-lg w-full max-w-3xl max-h-[80vh] overflow-auto",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-surface-700 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N(r.status),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r.name}),f(r.status)]}),e.jsx("button",{onClick:()=>k(null),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"×"})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5"}),"Server Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Server ID"}),e.jsx("p",{className:"font-mono text-sm text-gray-900 dark:text-white mt-1",children:r.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Transport Protocol"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:r.transport})]}),r.templateId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Template Type"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:r.templateId})]}),r.createdAt&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Created"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:new Date(r.createdAt).toLocaleString()})]}),r.createdBy&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Created By"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:r.createdBy})]}),r.lastConnected&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Last Connected"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white mt-1",children:new Date(r.lastConnected).toLocaleString()})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Configuration Details",e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-normal",children:"(for audit purposes)"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-surface-700/50 rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2",children:"Configured Integrations"}),r.configuration?.configuredIntegrations&&r.configuration.configuredIntegrations.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:r.configuration.configuredIntegrations.map(a=>e.jsxs("span",{className:"px-3 py-1 text-sm bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 rounded-full flex items-center gap-1",children:[e.jsx(u,{className:"w-4 h-4"}),a]},a))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No external integrations configured (using defaults)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2",children:"Evidence Types Collected"}),r.configuration?.evidenceTypes&&r.configuration.evidenceTypes.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:r.configuration.evidenceTypes.map(a=>e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 rounded",children:a},a))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"Evidence types determined by connected integrations"})]}),r.configuration?.command&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2",children:"Execution Command"}),e.jsxs("code",{className:"block p-2 bg-gray-900 dark:bg-black text-green-400 text-sm font-mono rounded overflow-x-auto",children:[r.configuration.command," ",r.configuration.args?.join(" ")]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-surface-600 pt-4",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2",children:"Credential Configuration Status"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{name:"AWS",keys:["AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY"]},{name:"Azure",keys:["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET"]},{name:"GitHub",keys:["GITHUB_TOKEN"]},{name:"Okta",keys:["OKTA_DOMAIN","OKTA_API_TOKEN"]},{name:"Google",keys:["GOOGLE_CLIENT_ID","GOOGLE_CLIENT_SECRET"]},{name:"Jamf",keys:["JAMF_URL","JAMF_USERNAME","JAMF_PASSWORD"]},{name:"OpenAI",keys:["OPENAI_API_KEY"]},{name:"Anthropic",keys:["ANTHROPIC_API_KEY"]}].map(a=>{const t=r.configuration?.configuredIntegrations?.includes(a.name);return e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded text-sm ${t?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-surface-700 text-gray-500 dark:text-gray-400"}`,children:[t?e.jsx(u,{className:"w-4 h-4"}):e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:a.name}),e.jsx("span",{className:"text-xs",children:t?"(configured)":"(not configured)"})]},a.name)})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Note: Actual credentials are encrypted and not displayed for security reasons."})]})]})]}),r.capabilities&&e.jsxs(e.Fragment,{children:[r.capabilities.tools.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5"}),"Available Tools (",r.capabilities.tools.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.capabilities.tools.map(a=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-surface-700 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.description})]},a.name))})]}),r.capabilities.resources.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:["Available Resources (",r.capabilities.resources.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.capabilities.resources.map(a=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-surface-700 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx("p",{className:"text-sm font-mono text-gray-500 dark:text-gray-400",children:a.uri})]},a.uri))})]}),r.capabilities.prompts.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:["Available Prompts (",r.capabilities.prompts.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.capabilities.prompts.map(a=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-surface-700 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.description})]},a.name))})]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-surface-700 pt-4",children:e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This configuration information is logged for audit purposes. Changes to server configuration are tracked in the Audit Log."})})]})]})})]})}export{Q as default};
