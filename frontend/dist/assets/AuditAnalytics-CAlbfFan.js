import{b as m,j as e,c0 as g,aa as j,v as b,S as y}from"./vendor-CWk44mA8.js";import{L as f}from"./LazyCharts-CLuWtu1O.js";const v={critical:"#ef4444",high:"#f97316",medium:"#eab308",low:"#22c55e",observation:"#6b7280"};function h({title:t,value:d,icon:u,trend:s,color:a}){return e.jsx("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:t}),e.jsx("p",{className:`text-3xl font-bold mt-1 ${a||"text-white"}`,children:d}),s&&e.jsx("p",{className:"text-sm text-surface-500 mt-1",children:s})]}),e.jsx("div",{className:`p-3 rounded-lg ${a?"bg-opacity-10":"bg-surface-700"}`,style:{backgroundColor:a?`${a}20`:void 0},children:e.jsx(u,{className:"h-6 w-6",style:{color:a||"#9ca3af"}})})]})})}function A(){const{data:t}=m({queryKey:["audit-analytics-dashboard"],queryFn:async()=>{const s=await fetch("/api/audit/analytics/dashboard");if(!s.ok)throw new Error("Failed to fetch dashboard");return s.json()}}),{data:d}=m({queryKey:["audit-analytics-findings"],queryFn:async()=>{const s=await fetch("/api/audit/analytics/findings");if(!s.ok)throw new Error("Failed to fetch findings");return s.json()}}),{data:u}=m({queryKey:["audit-analytics-trends"],queryFn:async()=>{const s=await fetch("/api/audit/analytics/trends?period=monthly");if(!s.ok)throw new Error("Failed to fetch trends");return s.json()}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Audit Analytics"}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Insights and trends across your audit program"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(h,{title:"Total Audits",value:t?.totalAudits||0,icon:g}),e.jsx(h,{title:"Active Audits",value:t?.activeAudits||0,icon:j,color:"#3b82f6"}),e.jsx(h,{title:"Open Findings",value:t?.openFindings||0,icon:b,color:"#f97316"}),e.jsx(h,{title:"Critical Findings",value:t?.criticalFindings||0,icon:b,color:"#ef4444"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Findings by Severity"}),e.jsx("div",{className:"h-64",children:e.jsx(f,{height:256,children:s=>{const{PieChart:a,Pie:n,Cell:l,Tooltip:c,Legend:o,ResponsiveContainer:x}=s,r=(d?.bySeverity||[]).map(i=>({name:i.severity,value:i.count}));return e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(a,{children:[e.jsx(n,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:r.map((i,p)=>e.jsx(l,{fill:v[i.name]||"#6b7280"},`cell-${p}`))}),e.jsx(c,{}),e.jsx(o,{})]})})}})})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Findings Trend"}),e.jsx("div",{className:"h-64",children:e.jsx(f,{height:256,children:s=>{const{AreaChart:a,Area:n,XAxis:l,YAxis:c,Tooltip:o,ResponsiveContainer:x}=s,r=u?.findings||[];return e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(a,{data:r,children:[e.jsx(l,{dataKey:"period",stroke:"#6b7280",fontSize:12}),e.jsx(c,{stroke:"#6b7280",fontSize:12}),e.jsx(o,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(n,{type:"monotone",dataKey:"count",stroke:"#8b5cf6",fill:"#8b5cf680"})]})})}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(j,{className:"h-6 w-6 text-brand-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Avg Remediation Time"})]}),e.jsxs("p",{className:"text-4xl font-bold text-white",children:[d?.avgRemediationDays||0,e.jsx("span",{className:"text-lg font-normal text-surface-400 ml-2",children:"days"})]})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Audit Completion Rate"})]}),e.jsxs("p",{className:"text-4xl font-bold text-white",children:[t?.totalAudits?Math.round(t.completedAudits/t.totalAudits*100):0,e.jsx("span",{className:"text-lg font-normal text-surface-400 ml-1",children:"%"})]})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(g,{className:"h-6 w-6 text-blue-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Request Completion"})]}),e.jsxs("p",{className:"text-4xl font-bold text-white",children:[t?.totalRequests?Math.round((t.totalRequests-t.openRequests)/t.totalRequests*100):0,e.jsx("span",{className:"text-lg font-normal text-surface-400 ml-1",children:"%"})]})]})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Findings by Category"}),e.jsx("div",{className:"h-64",children:e.jsx(f,{height:256,children:s=>{const{BarChart:a,Bar:n,XAxis:l,YAxis:c,Tooltip:o,ResponsiveContainer:x}=s,r=d?.byCategory||[];return e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(a,{data:r,layout:"vertical",children:[e.jsx(l,{type:"number",stroke:"#6b7280",fontSize:12}),e.jsx(c,{type:"category",dataKey:"category",stroke:"#6b7280",fontSize:12,width:150,tickFormatter:i=>i.replace(/_/g," ")}),e.jsx(o,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(n,{dataKey:"count",fill:"#8b5cf6",radius:[0,4,4,0]})]})})}})})]})]})}export{A as default};
