import{aS as P,k as T,u as F,r as d,b as B,c as y,j as e,bT as $,aO as A,a8 as I,B as x,aQ as E,h as M,L as j,w as O,z,y as L,m as Q,aD as m}from"./vendor-CWk44mA8.js";import{B as c,d as b}from"./index-CiJwl-Bo.js";import{b as K,c as w}from"./Skeleton-DVOICtGK.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const v=[{value:"tier_1_critical",label:"Tier 1 - Critical",color:"bg-red-500/20 text-red-400 border-red-500/30"},{value:"tier_2_essential",label:"Tier 2 - Essential",color:"bg-orange-500/20 text-orange-400 border-orange-500/30"},{value:"tier_3_important",label:"Tier 3 - Important",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"},{value:"tier_4_standard",label:"Tier 4 - Standard",color:"bg-blue-500/20 text-blue-400 border-blue-500/30"}];function U(){const{id:l}=P(),u=T(),p=F(),[k,o]=d.useState(!1),[C,N]=d.useState(!1),[n,D]=d.useState("overview"),[r,i]=d.useState({name:"",description:"",department:"",criticality_tier:"tier_3_important",rto_hours:24,rpo_hours:4,mtpd_hours:72,impact_description:"",recovery_priority:1,minimum_staff_required:1,alternate_site_required:!1,manual_workaround_available:!1,workaround_description:""}),{data:a,isLoading:R,error:S}=B({queryKey:["business-process",l],queryFn:async()=>(await b.get(`/api/bcdr/processes/${l}`)).data,enabled:!!l});d.useEffect(()=>{a&&i({name:a.name||"",description:a.description||"",department:a.department||"",criticality_tier:a.criticality_tier||"tier_3_important",rto_hours:a.rto_hours||24,rpo_hours:a.rpo_hours||4,mtpd_hours:a.mtpd_hours||72,impact_description:a.impact_description||"",recovery_priority:a.recovery_priority||1,minimum_staff_required:a.minimum_staff_required||1,alternate_site_required:a.alternate_site_required||!1,manual_workaround_available:a.manual_workaround_available||!1,workaround_description:a.workaround_description||""})},[a]);const h=y({mutationFn:async s=>(await b.patch(`/api/bcdr/processes/${l}`,s)).data,onSuccess:()=>{p.invalidateQueries({queryKey:["business-process",l]}),p.invalidateQueries({queryKey:["business-processes"]}),o(!1),m.success("Business process updated successfully")},onError:()=>{m.error("Failed to update business process")}}),f=y({mutationFn:async()=>{await b.delete(`/api/bcdr/processes/${l}`)},onSuccess:()=>{p.invalidateQueries({queryKey:["business-processes"]}),m.success("Business process deleted"),u("/bcdr/processes")},onError:()=>{m.error("Failed to delete business process")}}),q=s=>v.find(t=>t.value===s)||v[2],g=s=>s?new Date(s)<new Date:!1;if(R)return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(K,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(w,{})}),e.jsx("div",{children:e.jsx(w,{})})]})]});if(S||!a)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx($,{className:"w-12 h-12 mx-auto mb-4 text-red-400"}),e.jsx("h2",{className:"text-lg font-semibold text-surface-100 mb-2",children:"Business Process Not Found"}),e.jsx("p",{className:"text-surface-400 mb-4",children:"The requested business process could not be loaded."}),e.jsx(c,{onClick:()=>u("/bcdr/processes"),children:"Back to Processes"})]})});const _=q(a.criticality_tier);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:()=>u("/bcdr/processes"),className:"p-2 hover:bg-surface-700 rounded-lg text-surface-400 mt-1",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(I,{className:"w-8 h-8 text-brand-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-surface-100",children:a.name}),e.jsx("p",{className:"text-surface-400 text-sm",children:a.process_id})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:x("px-3 py-1 rounded-full text-sm font-medium border",_.color),children:_.label}),e.jsx("span",{className:x("px-3 py-1 rounded-full text-sm font-medium",a.is_active?"bg-green-500/20 text-green-400":"bg-surface-600 text-surface-400"),children:a.is_active?"Active":"Inactive"}),a.next_review_due&&g(a.next_review_due)&&e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-red-500/20 text-red-400",children:"Review Overdue"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"secondary",onClick:()=>o(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(c,{variant:"danger",onClick:()=>N(!0),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]}),e.jsx("div",{className:"border-b border-surface-700",children:e.jsx("nav",{className:"flex gap-6",children:["overview","dependencies","assets","plans"].map(s=>e.jsx("button",{onClick:()=>D(s),className:x("pb-3 px-1 text-sm font-medium border-b-2 transition-colors capitalize",n===s?"border-brand-500 text-brand-400":"border-transparent text-surface-400 hover:text-surface-200"),children:s},s))})}),n==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Description"}),e.jsx("p",{className:"text-surface-300",children:a.description||"No description provided."})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Recovery Objectives"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-surface-800/50",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"RTO"}),e.jsxs("p",{className:"text-2xl font-bold text-surface-100",children:[a.rto_hours||"N/A","h"]}),e.jsx("p",{className:"text-surface-500 text-xs",children:"Recovery Time Objective"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-surface-800/50",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"RPO"}),e.jsxs("p",{className:"text-2xl font-bold text-surface-100",children:[a.rpo_hours||"N/A","h"]}),e.jsx("p",{className:"text-surface-500 text-xs",children:"Recovery Point Objective"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-surface-800/50",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"MTPD"}),e.jsxs("p",{className:"text-2xl font-bold text-surface-100",children:[a.mtpd_hours||"N/A","h"]}),e.jsx("p",{className:"text-surface-500 text-xs",children:"Max Tolerable Downtime"})]})]})]}),a.impact_description&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Business Impact"}),e.jsx("p",{className:"text-surface-300",children:a.impact_description})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Continuity Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Recovery Priority"}),e.jsx("p",{className:"text-surface-100",children:a.recovery_priority||"Not set"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Minimum Staff Required"}),e.jsx("p",{className:"text-surface-100",children:a.minimum_staff_required||"Not set"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Alternate Site Required"}),e.jsx("p",{className:"text-surface-100",children:a.alternate_site_required?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Manual Workaround Available"}),e.jsx("p",{className:"text-surface-100",children:a.manual_workaround_available?"Yes":"No"})]})]}),a.workaround_description&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-surface-700",children:[e.jsx("p",{className:"text-surface-400 text-sm mb-2",children:"Workaround Description"}),e.jsx("p",{className:"text-surface-300",children:a.workaround_description})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Department"}),e.jsx("p",{className:"text-surface-100",children:a.department||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Owner"}),e.jsx("p",{className:"text-surface-100",children:a.owner_name||"-"}),a.owner_email&&e.jsx("p",{className:"text-surface-500 text-sm",children:a.owner_email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Next Review Due"}),e.jsx("p",{className:x("text-surface-100",a.next_review_due&&g(a.next_review_due)&&"text-red-400"),children:a.next_review_due?new Date(a.next_review_due).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Last Reviewed"}),e.jsx("p",{className:"text-surface-100",children:a.last_reviewed_at?new Date(a.last_reviewed_at).toLocaleDateString():"Never"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Statistics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Dependencies"}),e.jsx("span",{className:"text-surface-100",children:a.dependencies?.length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Assets"}),e.jsx("span",{className:"text-surface-100",children:a.assets?.length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"BC/DR Plans"}),e.jsx("span",{className:"text-surface-100",children:a.bcdr_plans?.length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Recovery Strategies"}),e.jsx("span",{className:"text-surface-100",children:a.recovery_strategies?.length||0})]})]})]})]})]}),n==="dependencies"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Process Dependencies"}),a.dependencies&&a.dependencies.length>0?e.jsx("div",{className:"space-y-2",children:a.dependencies.map(s=>e.jsx(j,{to:`/bcdr/processes/${s.dependent_process_id}`,className:"flex items-center justify-between p-4 rounded-lg bg-surface-800/50 hover:bg-surface-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-surface-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-100 font-medium",children:s.dependent_process_name}),e.jsx("p",{className:"text-surface-400 text-sm capitalize",children:s.dependency_type})]})]})},s.id))}):e.jsx("p",{className:"text-surface-400 text-center py-8",children:"No dependencies configured"})]}),n==="assets"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Supporting Assets"}),a.assets&&a.assets.length>0?e.jsx("div",{className:"space-y-2",children:a.assets.map(s=>e.jsx(j,{to:`/assets/${s.asset_id}`,className:"flex items-center justify-between p-4 rounded-lg bg-surface-800/50 hover:bg-surface-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"w-5 h-5 text-surface-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-100 font-medium",children:s.asset_name}),e.jsx("p",{className:"text-surface-400 text-sm capitalize",children:s.asset_type})]})]})},s.id))}):e.jsx("p",{className:"text-surface-400 text-center py-8",children:"No assets linked"})]}),n==="plans"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"BC/DR Plans"}),a.bcdr_plans&&a.bcdr_plans.length>0?e.jsx("div",{className:"space-y-2",children:a.bcdr_plans.map(s=>e.jsxs(j,{to:`/bcdr/plans/${s.id}`,className:"flex items-center justify-between p-4 rounded-lg bg-surface-800/50 hover:bg-surface-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"w-5 h-5 text-surface-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-100 font-medium",children:s.title}),e.jsx("p",{className:"text-surface-400 text-sm",children:s.plan_id})]})]}),e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-surface-700 text-surface-300 capitalize",children:s.status})]},s.id))}):e.jsx("p",{className:"text-surface-400 text-center py-8",children:"No BC/DR plans linked"})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-surface-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Edit Business Process"}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-surface-700 rounded-lg text-surface-400",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),h.mutate(r)},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>i(t=>({...t,name:s.target.value})),required:!0,className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:s=>i(t=>({...t,description:s.target.value})),rows:3,className:"input w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:r.department,onChange:s=>i(t=>({...t,department:s.target.value})),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Criticality Tier"}),e.jsx("select",{value:r.criticality_tier,onChange:s=>i(t=>({...t,criticality_tier:s.target.value})),className:"input w-full",children:v.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"RTO (hours)"}),e.jsx("input",{type:"number",value:r.rto_hours,onChange:s=>i(t=>({...t,rto_hours:parseInt(s.target.value)||0})),min:"0",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"RPO (hours)"}),e.jsx("input",{type:"number",value:r.rpo_hours,onChange:s=>i(t=>({...t,rpo_hours:parseInt(s.target.value)||0})),min:"0",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"MTPD (hours)"}),e.jsx("input",{type:"number",value:r.mtpd_hours,onChange:s=>i(t=>({...t,mtpd_hours:parseInt(s.target.value)||0})),min:"0",className:"input w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Business Impact Description"}),e.jsx("textarea",{value:r.impact_description,onChange:s=>i(t=>({...t,impact_description:s.target.value})),rows:2,className:"input w-full",placeholder:"Describe the impact if this process is unavailable..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Recovery Priority"}),e.jsx("input",{type:"number",value:r.recovery_priority,onChange:s=>i(t=>({...t,recovery_priority:parseInt(s.target.value)||1})),min:"1",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Minimum Staff Required"}),e.jsx("input",{type:"number",value:r.minimum_staff_required,onChange:s=>i(t=>({...t,minimum_staff_required:parseInt(s.target.value)||0})),min:"0",className:"input w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.alternate_site_required,onChange:s=>i(t=>({...t,alternate_site_required:s.target.checked})),className:"rounded border-surface-600 bg-surface-700 text-brand-600"}),e.jsx("span",{className:"text-surface-300 text-sm",children:"Alternate Site Required"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.manual_workaround_available,onChange:s=>i(t=>({...t,manual_workaround_available:s.target.checked})),className:"rounded border-surface-600 bg-surface-700 text-brand-600"}),e.jsx("span",{className:"text-surface-300 text-sm",children:"Manual Workaround Available"})]})]}),r.manual_workaround_available&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-2",children:"Workaround Description"}),e.jsx("textarea",{value:r.workaround_description,onChange:s=>i(t=>({...t,workaround_description:s.target.value})),rows:2,className:"input w-full"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-surface-700",children:[e.jsx(c,{variant:"secondary",type:"button",onClick:()=>o(!1),children:"Cancel"}),e.jsx(c,{type:"submit",disabled:h.isPending,children:h.isPending?"Saving...":"Save Changes"})]})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Delete Business Process"}),e.jsxs("p",{className:"text-surface-400 mb-6",children:['Are you sure you want to delete "',a.name,'"? This action cannot be undone and will remove all associated data.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(c,{variant:"secondary",onClick:()=>N(!1),children:"Cancel"}),e.jsx(c,{variant:"danger",onClick:()=>f.mutate(),disabled:f.isPending,children:f.isPending?"Deleting...":"Delete"})]})]})})]})}export{U as default};
