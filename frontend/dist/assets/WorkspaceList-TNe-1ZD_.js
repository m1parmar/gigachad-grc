import{k as M,r as l,b as v,j as e,t as p,E as F,p as E,M as R,l as $,g as q,bC as L,aM as z,S as A}from"./vendor-CWk44mA8.js";import{c as D,d as k}from"./index-CiJwl-Bo.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";function T({isOpen:u,onClose:a,onCreate:g}){const[o,c]=l.useState(""),[i,n]=l.useState(""),[t,x]=l.useState(!1),h=async r=>{if(r.preventDefault(),!!o.trim()){x(!0);try{await g({name:o.trim(),description:i.trim()||void 0}),c(""),n(""),a()}catch(f){console.error("Failed to create workspace:",f)}finally{x(!1)}}};return u?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-surface-800 rounded-lg shadow-xl w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Create New Workspace"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Workspace Name *"}),e.jsx("input",{type:"text",value:o,onChange:r=>c(r.target.value),placeholder:"e.g., Product A, Enterprise Edition",className:"w-full px-3 py-2 bg-surface-700 border border-surface-600 rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-brand-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Description (optional)"}),e.jsx("textarea",{value:i,onChange:r=>n(r.target.value),placeholder:"Brief description of this workspace...",rows:2,className:"w-full px-3 py-2 bg-surface-700 border border-surface-600 rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-brand-500 resize-none"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!o.trim()||t,className:"px-4 py-2 text-sm bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Creating...":"Create Workspace"})]})]})]})}):null}function O(){const u=M(),{isMultiWorkspaceEnabled:a,enableMultiWorkspace:g,createWorkspace:o,setCurrentWorkspace:c,currentWorkspace:i,canManageWorkspaces:n}=D(),[t,x]=l.useState(""),[h,r]=l.useState(!1),[f,j]=l.useState(!1),{data:d}=v({queryKey:["org-dashboard"],queryFn:()=>k.get("/api/workspaces/org/dashboard").then(s=>s.data),enabled:a}),{data:y=[],refetch:N}=v({queryKey:["workspaces"],queryFn:()=>k.get("/api/workspaces").then(s=>s.data),enabled:a}),C=async()=>{j(!0);try{await g(),N()}catch(s){console.error("Failed to enable multi-workspace mode:",s)}finally{j(!1)}},W=async s=>{const m=await o(s);c(m),N()},w=y.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.description?.toLowerCase().includes(t.toLowerCase())),S=s=>{switch(s){case"active":return e.jsx(A,{className:"w-4 h-4 text-green-400"});case"inactive":return e.jsx(z,{className:"w-4 h-4 text-yellow-400"});case"archived":return e.jsx(L,{className:"w-4 h-4 text-muted-foreground"});default:return null}};return a?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Workspaces"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage workspaces for your organization"})]}),n&&e.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700",children:[e.jsx(R,{className:"w-5 h-5"}),"New Workspace"]})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-surface-800 rounded-lg p-4 border border-surface-700",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Workspaces"}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:d.workspaces?.length||0})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-4 border border-surface-700",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Compliance Score"}),e.jsxs("p",{className:"text-2xl font-bold text-brand-400 mt-1",children:[d.avgComplianceScore||0,"%"]})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-4 border border-surface-700",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Controls"}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:d.totals?.controls||0})]}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-4 border border-surface-700",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Risks"}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:d.totals?.risks||0})]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search workspaces...",value:t,onChange:s=>x(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-surface-800 border border-surface-700 rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-brand-500"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(s=>{const m=d?.workspaces?.find(b=>b.id===s.id);return e.jsxs("div",{className:`bg-surface-800 rounded-lg p-5 border transition-all cursor-pointer hover:border-brand-500/50 ${i?.id===s.id?"border-brand-500 ring-1 ring-brand-500/30":"border-surface-700"}`,onClick:()=>{c(s),u("/dashboard")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-brand-400"}),e.jsx("h3",{className:"font-semibold text-foreground",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S(s.status),i?.id===s.id&&e.jsx("span",{className:"text-xs bg-brand-600/20 text-brand-400 px-2 py-0.5 rounded",children:"Active"})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4 text-center",children:[e.jsxs("div",{className:"bg-surface-700/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Controls"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:m?.stats?.controls||0})]}),e.jsxs("div",{className:"bg-surface-700/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Risks"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:m?.stats?.risks||0})]}),e.jsxs("div",{className:"bg-surface-700/50 rounded p-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Score"}),e.jsxs("p",{className:"text-sm font-medium text-brand-400",children:[m?.complianceScore||0,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-surface-700",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.memberCount||0," members"]}),n&&e.jsx("button",{onClick:b=>{b.stopPropagation(),u(`/settings/workspaces/${s.id}`)},className:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-surface-700 rounded",children:e.jsx(q,{className:"w-4 h-4"})})]})]},s.id)})}),w.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:t?"No workspaces match your search.":"No workspaces yet."})]}),e.jsx(T,{isOpen:h,onClose:()=>r(!1),onCreate:W})]}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center py-12",children:[e.jsx(p,{className:"w-16 h-16 text-muted-foreground mx-auto mb-6"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Multi-Workspace Mode"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Enable multi-workspace mode to manage multiple products or services with separate compliance tracking, while sharing a common control library across your organization."}),e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 text-left mb-8",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"What you get with workspaces:"}),e.jsxs("ul",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"w-5 h-5 text-brand-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Track compliance progress independently for each product"})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-brand-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Assign different team members to different workspaces"})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(p,{className:"w-5 h-5 text-brand-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Consolidated org-level dashboard for executives"})]})]})]}),n?e.jsx("button",{onClick:C,disabled:f,className:"px-6 py-3 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50",children:f?"Enabling...":"Enable Multi-Workspace Mode"}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact your administrator to enable multi-workspace mode."})]})})}export{O as default};
