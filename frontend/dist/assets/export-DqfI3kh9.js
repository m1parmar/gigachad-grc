const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-CWk44mA8.js","assets/vendor-C9-ySRfk.css"])))=>i.map(i=>d[i]);
import{an as S}from"./vendor-CWk44mA8.js";function u(e){if(e==null)return"";const t=String(e);return t.includes(",")||t.includes(`
`)||t.includes('"')?`"${t.replace(/"/g,'""')}"`:t}function C(e,t){const i=e.map(r=>u(r.header)).join(","),o=t.map(r=>e.map(a=>{const s=a.key,c=s.includes(".")?s.split(".").reduce((n,l)=>n?.[l],r):r[s],d=a.transform?a.transform(c,r):c;return u(d)}).join(","));return[i,...o].join(`
`)}let f=null;async function b(){return f||(f=await S(()=>import("./vendor-CWk44mA8.js").then(e=>e.e),__vite__mapDeps([0,1]))),f}async function x(e,t,i){const o=await b(),r=new o.Workbook,a=r.addWorksheet(i),s=e.map(n=>n.header);return a.addRow(s).eachCell(n=>{n.font={bold:!0},n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}}}),t.forEach(n=>{const l=e.map(h=>{const p=h.key,y=p.includes(".")?p.split(".").reduce((k,m)=>k?.[m],n):n[p];return h.transform?h.transform(y,n):y});a.addRow(l)}),a.columns.forEach((n,l)=>{const h=Math.max(s[l]?.length||10,...t.map(p=>{const y=e[l].key,k=y.includes(".")?y.split(".").reduce((w,D)=>w?.[D],p):p[y],m=e[l].transform?e[l].transform(k,p):k;return String(m??"").length}));n.width=Math.min(h+2,50)}),await r.xlsx.writeBuffer()}function L(e,t){const i=t.map(o=>{const r={};return e.forEach(a=>{const s=a.key,c=s.includes(".")?s.split(".").reduce((d,n)=>d?.[n],o):o[s];r[a.header]=a.transform?a.transform(c,o):c}),r});return JSON.stringify(i,null,2)}function g(e,t,i){const o=new Blob([e],{type:i}),r=URL.createObjectURL(o),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}async function E(e){const{filename:t,columns:i,data:o,format:r,sheetName:a="Sheet1"}=e,s=new Date().toISOString().split("T")[0],c=`${t}_${s}`;switch(r){case"csv":{const d=C(i,o);g(d,`${c}.csv`,"text/csv;charset=utf-8;");break}case"xlsx":{const d=await x(i,o,a);g(d,`${c}.xlsx`,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");break}case"json":{const d=L(i,o);g(d,`${c}.json`,"application/json");break}}}const R={controls:[{key:"controlId",header:"Control ID"},{key:"title",header:"Title"},{key:"description",header:"Description"},{key:"status",header:"Status",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"category",header:"Category"},{key:"owner",header:"Owner"},{key:"implementationDate",header:"Implementation Date",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"lastReviewDate",header:"Last Review Date",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"nextReviewDate",header:"Next Review Date",transform:e=>e?new Date(e).toLocaleDateString():""}],risks:[{key:"title",header:"Title"},{key:"description",header:"Description"},{key:"riskLevel",header:"Risk Level",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"status",header:"Status",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"category",header:"Category"},{key:"likelihood",header:"Likelihood"},{key:"impact",header:"Impact"},{key:"owner",header:"Owner"},{key:"treatmentPlan",header:"Treatment Plan"},{key:"createdAt",header:"Created Date",transform:e=>e?new Date(e).toLocaleDateString():""}],vendors:[{key:"name",header:"Vendor Name"},{key:"description",header:"Description"},{key:"category",header:"Category"},{key:"riskTier",header:"Risk Tier",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"status",header:"Status",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"primaryContact",header:"Primary Contact"},{key:"contactEmail",header:"Contact Email"},{key:"website",header:"Website"},{key:"contractStartDate",header:"Contract Start",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"contractEndDate",header:"Contract End",transform:e=>e?new Date(e).toLocaleDateString():""}],policies:[{key:"title",header:"Title"},{key:"description",header:"Description"},{key:"status",header:"Status",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"category",header:"Category"},{key:"version",header:"Version"},{key:"owner",header:"Owner"},{key:"effectiveDate",header:"Effective Date",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"reviewDate",header:"Review Date",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"approvedBy",header:"Approved By"}],assets:[{key:"name",header:"Asset Name"},{key:"description",header:"Description"},{key:"type",header:"Type",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"criticality",header:"Criticality",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"status",header:"Status",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"owner",header:"Owner"},{key:"location",header:"Location"},{key:"dataClassification",header:"Data Classification"}],audits:[{key:"name",header:"Audit Name"},{key:"type",header:"Type",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"status",header:"Status",transform:e=>String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())},{key:"auditor",header:"Auditor"},{key:"startDate",header:"Start Date",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"endDate",header:"End Date",transform:e=>e?new Date(e).toLocaleDateString():""},{key:"framework",header:"Framework"}]};export{E as a,R as e};
