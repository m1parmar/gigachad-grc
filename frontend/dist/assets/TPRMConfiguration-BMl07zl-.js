import{r as p,u as F,b as N,c as w,j as e,g as q,ay as C,aa as D,a$ as M,y as T,A as $,aD as j}from"./vendor-CWk44mA8.js";import{D as y}from"./index-CiJwl-Bo.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";function K(){const[s,l]=p.useState("tiers"),t=F(),{data:o,isLoading:d,error:c}=N({queryKey:["tprm-config"],queryFn:async()=>(await y.get()).data}),{data:m}=N({queryKey:["tprm-config-reference"],queryFn:async()=>(await y.getReference()).data}),x=w({mutationFn:async r=>(await y.update(r)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["tprm-config"]}),j.success("Configuration saved")},onError:()=>{j.error("Failed to save configuration")}}),a=w({mutationFn:async()=>(await y.reset()).data,onSuccess:()=>{t.invalidateQueries({queryKey:["tprm-config"]}),j.success("Configuration reset to defaults")},onError:()=>{j.error("Failed to reset configuration")}}),u=[{key:"tiers",label:"Tier Review Schedule",icon:D},{key:"categories",label:"Vendor Categories",icon:M},{key:"assessments",label:"Assessment Settings",icon:T},{key:"contracts",label:"Contract Settings",icon:$}];return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-surface-400",children:"Loading configuration..."})}):c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-red-400",children:"Failed to load configuration"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-white flex items-center gap-3",children:[e.jsx(q,{className:"w-8 h-8 text-brand-400"}),"Third-Party Risk Management Configuration"]}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Configure vendor tiers, review schedules, categories, and assessment settings"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[x.isPending&&e.jsxs("span",{className:"text-brand-400 text-sm flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 animate-spin"}),"Saving..."]}),e.jsxs("button",{onClick:()=>{confirm("Reset all TPRM settings to defaults?")&&a.mutate()},disabled:a.isPending,className:"px-4 py-2 bg-surface-700 text-surface-300 rounded-lg hover:bg-surface-600 flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Reset to Defaults"]})]})]}),e.jsx("div",{className:"flex gap-2 border-b border-surface-700 pb-px",children:u.map(r=>e.jsxs("button",{onClick:()=>l(r.key),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 transition-colors ${s===r.key?"border-brand-500 text-brand-400":"border-transparent text-surface-400 hover:text-surface-300"}`,children:[e.jsx(r.icon,{className:"w-4 h-4"}),r.label]},r.key))}),e.jsxs("div",{className:"bg-surface-800 rounded-xl border border-surface-700 p-6",children:[s==="tiers"&&o&&m&&e.jsx(I,{config:o,referenceData:m,onUpdate:r=>x.mutate(r)}),s==="categories"&&o&&e.jsx(O,{config:o,onUpdate:r=>x.mutate(r)}),s==="assessments"&&o&&e.jsx(E,{config:o,onUpdate:r=>x.mutate(r)}),s==="contracts"&&o&&e.jsx(W,{config:o,onUpdate:r=>x.mutate(r)})]})]})}function S(s){const l={monthly:1,quarterly:3,semi_annual:6,annual:12,biennial:24};if(l[s])return l[s];if(s.startsWith("custom_")){const t=parseInt(s.replace("custom_",""),10);if(!isNaN(t)&&t>0)return t}return 12}function _(s){const l={monthly:"Monthly",quarterly:"Quarterly",semi_annual:"Semi-Annual",annual:"Annual",biennial:"Bi-Annual"};if(l[s])return l[s];if(s.startsWith("custom_")){const t=parseInt(s.replace("custom_",""),10);if(!isNaN(t)&&t>0)return t===1?"1 Month":t<12?`${t} Months`:t===12?"1 Year":t%12===0?`${t/12} Years`:`${t} Months`}return s}function k(s){return s.startsWith("custom_")}function I({config:s,referenceData:l,onUpdate:t}){const[o,d]=p.useState(s.tierFrequencyMapping),[c,m]=p.useState({}),[x,a]=p.useState({});p.useEffect(()=>{d(s.tierFrequencyMapping);const i={},n={};Object.entries(s.tierFrequencyMapping).forEach(([h,f])=>{k(f)&&(i[h]=S(f),n[h]=!0)}),m(i),a(n)},[s.tierFrequencyMapping]);const u=(i,n)=>{if(n==="custom"){a(v=>({...v,[i]:!0}));const h=c[i]||6;m(v=>({...v,[i]:h}));const f=`custom_${h}`,b={...o,[i]:f};d(b),t({tierFrequencyMapping:b})}else{a(f=>({...f,[i]:!1}));const h={...o,[i]:n};d(h),t({tierFrequencyMapping:h})}},r=(i,n)=>{n<1&&(n=1),n>60&&(n=60),m(b=>({...b,[i]:n}));const h=`custom_${n}`,f={...o,[i]:h};d(f),t({tierFrequencyMapping:f})},g=[{key:"tier_1",label:"Tier 1 (Critical)",description:"Critical vendors with highest risk exposure",color:"red"},{key:"tier_2",label:"Tier 2 (Important)",description:"Important vendors requiring regular oversight",color:"orange"},{key:"tier_3",label:"Tier 3 (Standard)",description:"Standard vendors with moderate risk",color:"yellow"},{key:"tier_4",label:"Tier 4 (Low Risk)",description:"Low-risk vendors with minimal exposure",color:"green"}],R=i=>{switch(i){case"red":return"bg-red-500/20 border-red-500/30 text-red-400";case"orange":return"bg-orange-500/20 border-orange-500/30 text-orange-400";case"yellow":return"bg-amber-500/20 border-amber-500/30 text-amber-400";case"green":return"bg-emerald-500/20 border-emerald-500/30 text-emerald-400";default:return"bg-surface-700 border-surface-600 text-surface-300"}},A=i=>{const n=o[i];return k(n)?"custom":n};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Tier-Based Review Schedule"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Configure how often vendors in each tier should be reviewed. Choose from predefined intervals or set a custom schedule in months. When a vendor's tier changes, their review schedule will automatically update based on these settings."})]}),e.jsx("div",{className:"space-y-4",children:g.map(i=>e.jsx("div",{className:`p-4 rounded-lg border ${R(i.color)}`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.label}),e.jsx("p",{className:"text-sm opacity-75",children:i.description})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("label",{className:"text-sm text-surface-400",children:"Review every:"}),e.jsxs("select",{value:A(i.key),onChange:n=>u(i.key,n.target.value),className:"px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white min-w-[180px]",children:[l.frequencyOptions.map(n=>e.jsx("option",{value:n.value,children:n.value==="custom"?"Custom...":`${n.label} (${n.months} month${n.months>1?"s":""})`},n.value)),!l.frequencyOptions.find(n=>n.value==="custom")&&e.jsx("option",{value:"custom",children:"Custom..."})]}),x[i.key]&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"1",max:"60",value:c[i.key]||6,onChange:n=>r(i.key,parseInt(n.target.value)||1),className:"w-20 px-3 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white text-center"}),e.jsx("span",{className:"text-sm text-surface-300",children:"months"})]})]})]})},i.key))}),e.jsxs("div",{className:"p-4 bg-surface-700/50 rounded-lg",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Review Schedule Summary"}),e.jsx("div",{className:"grid grid-cols-4 gap-4 text-sm",children:g.map(i=>{const n=o[i.key],h=S(n);return e.jsxs("div",{className:"text-center p-3 bg-surface-800 rounded-lg",children:[e.jsx("p",{className:"text-surface-400 text-xs mb-1",children:i.label}),e.jsx("p",{className:"text-white font-medium",children:_(n)}),e.jsxs("p",{className:"text-surface-500 text-xs mt-1",children:["(",h," month",h!==1?"s":"",")"]})]},i.key)})})]})]})}function O({config:s,onUpdate:l}){const[t,o]=p.useState(s.vendorCategories),[d,c]=p.useState({name:"",description:"",color:"#6366f1"});p.useEffect(()=>{o(s.vendorCategories)},[s.vendorCategories]);const m=()=>{if(d.name){const a=[...t,{...d,id:`cat-${Date.now()}`}];o(a),l({vendorCategories:a}),c({name:"",description:"",color:"#6366f1"})}},x=a=>{const u=t.filter(r=>r.id!==a);o(u),l({vendorCategories:u})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Vendor Categories"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Define categories to classify your vendors. Categories help organize and filter vendors."})]}),e.jsx("div",{className:"space-y-3",children:t.map(a=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-surface-700/50 rounded-lg",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:a.color}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-surface-400 text-sm",children:a.description})]}),e.jsx("button",{onClick:()=>x(a.id),className:"text-surface-400 hover:text-red-400 text-sm",children:"Remove"})]},a.id))}),e.jsxs("div",{className:"pt-4 border-t border-surface-700",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Add Category"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",placeholder:"Category name",value:d.name,onChange:a=>c(u=>({...u,name:a.target.value})),className:"flex-1 px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white placeholder:text-surface-500"}),e.jsx("input",{type:"text",placeholder:"Description",value:d.description,onChange:a=>c(u=>({...u,description:a.target.value})),className:"flex-1 px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white placeholder:text-surface-500"}),e.jsx("input",{type:"color",value:d.color,onChange:a=>c(u=>({...u,color:a.target.value})),className:"w-12 h-10 rounded cursor-pointer"}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-brand-500 text-white rounded-lg hover:bg-brand-600",children:"Add"})]})]})]})}function E({config:s,onUpdate:l}){const[t,o]=p.useState(s.assessmentSettings);p.useEffect(()=>{o(s.assessmentSettings)},[s.assessmentSettings]);const d=(c,m)=>{const x={...t,[c]:m};o(x),l({assessmentSettings:x})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Assessment Settings"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Configure vendor assessment workflow and automation settings."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center justify-between p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Require Document Upload"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Require vendors to upload documents for assessments"})]}),e.jsx("input",{type:"checkbox",checked:t.requireDocumentUpload??!1,onChange:c=>d("requireDocumentUpload",c.target.checked),className:"rounded border-surface-600"})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Auto-Create Assessment on New Vendor"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Automatically create an initial assessment when adding a new vendor"})]}),e.jsx("input",{type:"checkbox",checked:t.autoCreateAssessmentOnNewVendor??!1,onChange:c=>d("autoCreateAssessmentOnNewVendor",c.target.checked),className:"rounded border-surface-600"})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Enable AI Analysis"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Allow AI-assisted analysis of SOC 2 reports and other vendor documents"})]}),e.jsx("input",{type:"checkbox",checked:t.enableAIAnalysis??!0,onChange:c=>d("enableAIAnalysis",c.target.checked),className:"rounded border-surface-600"})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Notify on Overdue Review"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Send notifications when vendor reviews become overdue"})]}),e.jsx("input",{type:"checkbox",checked:t.notifyOnOverdueReview??!0,onChange:c=>d("notifyOnOverdueReview",c.target.checked),className:"rounded border-surface-600"})]}),e.jsxs("div",{className:"p-4 bg-surface-700/50 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Overdue Reminder Days"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Days before a review is due to send reminders"})]})}),e.jsx("input",{type:"number",value:t.overdueReminderDays??7,onChange:c=>d("overdueReminderDays",parseInt(c.target.value)),min:"1",max:"90",className:"w-24 px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"p-4 bg-surface-700/50 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Default Assessment Type"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Default assessment type for new assessments"})]})}),e.jsxs("select",{value:t.defaultAssessmentType??"standard",onChange:c=>d("defaultAssessmentType",c.target.value),className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white",children:[e.jsx("option",{value:"standard",children:"Standard Assessment"}),e.jsx("option",{value:"questionnaire",children:"Questionnaire-Based"}),e.jsx("option",{value:"soc2_review",children:"SOC 2 Review"}),e.jsx("option",{value:"security_review",children:"Security Review"}),e.jsx("option",{value:"privacy_review",children:"Privacy Review"})]})]})]})]})}function W({config:s,onUpdate:l}){const[t,o]=p.useState(s.contractSettings),[d,c]=p.useState((s.contractSettings.expirationWarningDays||[90,60,30,14,7]).join(", "));p.useEffect(()=>{o(s.contractSettings),c((s.contractSettings.expirationWarningDays||[90,60,30,14,7]).join(", "))},[s.contractSettings]);const m=(a,u)=>{const r={...t,[a]:u};o(r),l({contractSettings:r})},x=a=>{c(a);const u=a.split(",").map(r=>parseInt(r.trim())).filter(r=>!isNaN(r)&&r>0);u.length>0&&m("expirationWarningDays",u.sort((r,g)=>g-r))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Contract Settings"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Configure contract management and expiration notification settings."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-white",children:"Expiration Warning Days"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Days before contract expiration to send warnings (comma-separated)"})]}),e.jsx("input",{type:"text",value:d,onChange:a=>x(a.target.value),placeholder:"90, 60, 30, 14, 7",className:"w-full px-4 py-2 bg-surface-700 border border-surface-600 rounded-lg text-white placeholder:text-surface-500"}),e.jsxs("p",{className:"text-surface-500 text-xs mt-2",children:["Current: ",(t.expirationWarningDays||[]).join(", ")," days before expiration"]})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Require Security Addendum"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Flag contracts that don't have a security addendum attached"})]}),e.jsx("input",{type:"checkbox",checked:t.requireSecurityAddendum??!1,onChange:a=>m("requireSecurityAddendum",a.target.checked),className:"rounded border-surface-600"})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 bg-surface-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:"Auto-Renewal Notification"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"Send notification when contracts with auto-renewal clauses are about to renew"})]}),e.jsx("input",{type:"checkbox",checked:t.autoRenewNotification??!0,onChange:a=>m("autoRenewNotification",a.target.checked),className:"rounded border-surface-600"})]})]})]})}export{K as default};
