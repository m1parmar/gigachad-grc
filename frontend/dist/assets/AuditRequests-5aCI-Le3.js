import{k as b,r as t,aD as w,j as e,M as p,l as N,L as y,v as C,y as k}from"./vendor-CWk44mA8.js";import{B as L}from"./index-CiJwl-Bo.js";import{d as R}from"./Skeleton-DVOICtGK.js";import{E as S,N as _}from"./EmptyState-DqJSE5Oy.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const F={open:"bg-blue-100 text-blue-800",in_progress:"bg-yellow-100 text-yellow-800",submitted:"bg-purple-100 text-purple-800",under_review:"bg-orange-100 text-orange-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",clarification_needed:"bg-pink-100 text-pink-800"},A={low:"text-gray-400",medium:"text-yellow-400",high:"text-orange-400",critical:"text-red-400"},D={control_documentation:"Control Documentation",policy:"Policy",evidence:"Evidence",interview:"Interview",access:"Access",walkthrough:"Walkthrough"};function z(){const o=b(),[c,m]=t.useState([]),[h,f]=t.useState(!0),[a,l]=t.useState(""),[r,d]=t.useState(""),[n]=t.useState(""),[i,u]=t.useState("");t.useEffect(()=>{g()},[r,n,i]);const g=async()=>{try{const s=new URLSearchParams;r&&s.append("status",r),n&&s.append("auditId",n),i&&s.append("priority",i);const v=await(await fetch(`/api/audit-requests?${s}`,{headers:{"x-organization-id":"default-org","x-user-id":"system"}})).json();m(v)}catch(s){console.error("Error fetching requests:",s),w.error("Failed to load audit requests")}finally{f(!1)}},x=c.filter(s=>s.title.toLowerCase().includes(a.toLowerCase())||s.requestNumber.toLowerCase().includes(a.toLowerCase())||s.audit.name.toLowerCase().includes(a.toLowerCase())),j=s=>s?new Date(s)<new Date:!1;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-surface-100",children:"Audit Requests"}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Manage evidence and documentation requests from auditors"})]}),e.jsx(L,{onClick:()=>o("/audit-requests/new"),leftIcon:e.jsx(p,{className:"w-5 h-5"}),children:"New Request"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(N,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-surface-500"}),e.jsx("input",{type:"text",placeholder:"Search requests...",value:a,onChange:s=>l(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 placeholder-surface-500 focus:outline-none focus:ring-2 focus:ring-brand-500"})]}),e.jsxs("select",{value:r,onChange:s=>d(s.target.value),className:"px-4 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:ring-2 focus:ring-brand-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"under_review",children:"Under Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"clarification_needed",children:"Clarification Needed"})]}),e.jsxs("select",{value:i,onChange:s=>u(s.target.value),className:"px-4 py-2 bg-surface-800 border border-surface-700 rounded-lg text-surface-100 focus:outline-none focus:ring-2 focus:ring-brand-500",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),h?e.jsx(R,{count:6}):c.length===0?e.jsx(S,{variant:"checklist",title:"No audit requests yet",description:"Create audit requests to track evidence and documentation requirements from auditors.",action:{label:"New Request",onClick:()=>o("/audit-requests/new"),icon:e.jsx(p,{className:"w-5 h-5"})}}):x.length===0?e.jsx(_,{searchTerm:a,onClear:()=>{l(""),d(""),u("")}}):e.jsx("div",{className:"grid gap-4",children:x.map(s=>e.jsxs(y,{to:`/audit-requests/${s.id}`,className:"block bg-surface-800 border border-surface-700 rounded-lg p-6 hover:border-brand-500 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:s.title}),e.jsxs("span",{className:"text-sm text-surface-500",children:["#",s.requestNumber]}),e.jsx("span",{className:`${A[s.priority]}`,children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-surface-400",children:[e.jsx("span",{children:D[s.category]}),e.jsxs("span",{children:["• Audit: ",s.audit.name]}),s.dueDate&&e.jsxs("span",{className:j(s.dueDate)?"text-red-400":"",children:["• Due: ",new Date(s.dueDate).toLocaleDateString()]})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${F[s.status]}`,children:s.status.replace("_"," ").charAt(0).toUpperCase()+s.status.replace("_"," ").slice(1)})]}),e.jsxs("div",{className:"flex items-center gap-6 pt-4 border-t border-surface-700 text-sm text-surface-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsxs("span",{children:[s._count.evidence," evidence items"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsxs("span",{children:[s._count.comments," comments"]})]}),s.assignedTo&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{children:["Assigned to: ",s.assignedTo]})})]})]},s.id))})]})}export{z as default};
