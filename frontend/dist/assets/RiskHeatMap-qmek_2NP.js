import{k as O,r as j,j as e,B as N}from"./vendor-CWk44mA8.js";const v=["rare","unlikely","possible","likely","almost_certain"],y=["negligible","minor","moderate","significant","severe"],L={rare:"Rare",unlikely:"Unlikely",possible:"Possible",likely:"Likely",almost_certain:"Almost Certain"},k={negligible:"Negligible",minor:"Minor",moderate:"Moderate",significant:"Significant",severe:"Severe"},M=(l,p)=>{const d=(l+1)*(p+1);return d<=4?"low":d<=9?"medium":d<=16?"high":"critical"},_={low:"bg-emerald-500/30 hover:bg-emerald-500/40 border-emerald-500/50",medium:"bg-amber-500/30 hover:bg-amber-500/40 border-amber-500/50",high:"bg-orange-500/30 hover:bg-orange-500/40 border-orange-500/50",critical:"bg-red-500/30 hover:bg-red-500/40 border-red-500/50"},R={low:"bg-emerald-400",medium:"bg-amber-400",high:"bg-orange-400",critical:"bg-red-400"};function A({risks:l,onRiskClick:p,showLegend:d=!0,className:E}){const $=O(),[n,m]=j.useState(null),[r,x]=j.useState(null),a=j.useMemo(()=>{const s={};return l.forEach(t=>{const c=t.likelihood?.toLowerCase()||"possible",o=t.impact?.toLowerCase()||"moderate",h=`${c}-${o}`;s[h]||(s[h]=[]),s[h].push(t)}),s},[l]),w=(s,t)=>{const c=`${s}-${t}`;x(r===c?null:c)},u=(s,t)=>{t.stopPropagation(),p?p(s):$(`/risks/${s.id}`)},i=j.useMemo(()=>{let s=0,t=0,c=0,o=0;return v.forEach((h,g)=>{y.forEach((f,C)=>{const I=`${h}-${f}`,b=a[I]?.length||0,S=M(g,C);S==="low"?s+=b:S==="medium"?t+=b:S==="high"?c+=b:o+=b})}),{low:s,medium:t,high:c,critical:o,total:l.length}},[a,l.length]);return e.jsxs("div",{className:N("space-y-4",E),children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex flex-col justify-center items-center w-8 mr-2",children:e.jsx("span",{className:"text-xs text-surface-400 transform -rotate-90 whitespace-nowrap",children:"LIKELIHOOD →"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"grid grid-cols-5 gap-1",children:[...v].reverse().map((s,t)=>{const c=v.length-1-t;return y.map((o,h)=>{const g=`${s}-${o}`,f=a[g]||[],C=M(c,h),I=n===g,b=r===g;return e.jsxs("div",{className:N("aspect-square rounded-lg border transition-all cursor-pointer relative",_[C],b&&"ring-2 ring-brand-500","flex items-center justify-center"),onMouseEnter:()=>m(g),onMouseLeave:()=>m(null),onClick:()=>w(s,o),children:[f.length>0&&e.jsx("div",{className:N("w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",R[C],"text-surface-900"),children:f.length}),I&&f.length>0&&e.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-50 pointer-events-none",children:[e.jsxs("div",{className:"bg-surface-900 border border-surface-700 rounded-lg shadow-xl p-3 min-w-[200px]",children:[e.jsxs("p",{className:"text-xs text-surface-400 mb-1",children:[L[s]," × ",k[o]]}),e.jsxs("p",{className:"text-sm font-medium text-surface-100",children:[f.length," risk",f.length>1?"s":""]})]}),e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-8 border-transparent border-t-surface-700"})]})]},g)})})}),e.jsx("div",{className:"grid grid-cols-5 gap-1 mt-2",children:y.map(s=>e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-xs text-surface-400",children:k[s]})},s))}),e.jsx("div",{className:"text-center mt-1",children:e.jsx("span",{className:"text-xs text-surface-500",children:"IMPACT →"})})]}),e.jsx("div",{className:"flex flex-col justify-between ml-2 py-1",children:[...v].reverse().map(s=>e.jsx("span",{className:"text-xs text-surface-400 whitespace-nowrap",children:L[s]},s))})]}),r&&a[r]?.length>0&&e.jsxs("div",{className:"bg-surface-800 border border-surface-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-medium text-surface-100",children:[L[r.split("-")[0]]," × ",k[r.split("-")[1]]]}),e.jsx("button",{onClick:()=>x(null),className:"text-xs text-surface-400 hover:text-surface-200",children:"Close"})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a[r].map(s=>e.jsxs("div",{onClick:t=>u(s,t),className:"p-2 bg-surface-700/50 hover:bg-surface-700 rounded-lg cursor-pointer transition-colors",children:[e.jsx("p",{className:"text-sm font-medium text-surface-100",children:s.title}),e.jsxs("p",{className:"text-xs text-surface-400",children:[s.riskId," • ",s.category||"Uncategorized"]})]},s.id))})]}),d&&e.jsxs("div",{className:"flex items-center justify-between bg-surface-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-emerald-400"}),e.jsxs("span",{className:"text-xs text-surface-400",children:["Low (",i.low,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-amber-400"}),e.jsxs("span",{className:"text-xs text-surface-400",children:["Medium (",i.medium,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-orange-400"}),e.jsxs("span",{className:"text-xs text-surface-400",children:["High (",i.high,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-red-400"}),e.jsxs("span",{className:"text-xs text-surface-400",children:["Critical (",i.critical,")"]})]})]}),e.jsxs("span",{className:"text-xs text-surface-500",children:["Total: ",i.total," risk",i.total!==1?"s":""]})]})]})}function B({risks:l,className:p,showCounts:d=!0}){const E=O(),$=j.useMemo(()=>{const n={};return l.forEach(m=>{const r=m.likelihood?.toLowerCase()||"possible",x=m.impact?.toLowerCase()||"moderate",a=`${r}-${x}`;n[a]=(n[a]||0)+1}),n},[l]);return e.jsx("div",{className:N("cursor-pointer",p),onClick:()=>E("/risks?view=heatmap"),children:e.jsx("div",{className:"grid grid-cols-5 gap-1",children:[...v].reverse().map((n,m)=>{const r=v.length-1-m;return y.map((x,a)=>{const w=`${n}-${x}`,u=$[w]||0,i=M(r,a);return e.jsx("div",{className:N("aspect-square rounded flex items-center justify-center text-xs font-medium transition-transform hover:scale-105",u>0?R[i]:"bg-surface-700/50",u>0?"text-white/90":"text-surface-500"),title:`${L[n]} × ${k[x]}: ${u} risks`,children:d&&u>0?u:""},w)})})})})}export{B as C,A as R};
