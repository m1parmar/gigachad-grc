import{r as c,b as f,j as e,bT as w,L as u,M as _,l as R,ay as S,X as F,B as C,aa as k}from"./vendor-CWk44mA8.js";import{d as N}from"./index-CiJwl-Bo.js";import{u as P}from"./useDebounce-BWtFJvQ9.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const A={draft:"bg-surface-600 text-surface-300",approved:"bg-blue-500/20 text-blue-400",published:"bg-green-500/20 text-green-400",needs_review:"bg-yellow-500/20 text-yellow-400",archived:"bg-surface-700 text-surface-400"},$={system_recovery:"ðŸ’»",data_restore:"ðŸ’¾",failover:"ðŸ”„",communication:"ðŸ“¢",network:"ðŸŒ",security:"ðŸ”’",general:"ðŸ“‹"};function K(){const[p,b]=c.useState(""),[a,v]=c.useState(""),[t,g]=c.useState(""),[r,x]=c.useState(1),l=P(p,300);c.useEffect(()=>{x(1)},[l,a,t]);const{data:n,isLoading:y,error:h,refetch:j}=f({queryKey:["runbooks",l,a,t,r],queryFn:async()=>{const s=new URLSearchParams;return l&&s.append("search",l),a&&s.append("status",a),t&&s.append("category",t),s.append("page",r.toString()),s.append("limit","24"),(await N.get(`/api/bcdr/runbooks?${s}`)).data},retry:1}),m=Array.isArray(n)?n:n?.data??[],i=n?.totalPages||1,{data:d,isLoading:o}=f({queryKey:["runbooks-stats"],queryFn:async()=>(await N.get("/api/bcdr/runbooks/stats")).data,staleTime:3e4});return h?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(w,{className:"w-12 h-12 mx-auto mb-4 text-red-400"}),e.jsx("h2",{className:"text-lg font-semibold text-surface-100 mb-2",children:"Failed to load Runbooks"}),e.jsx("p",{className:"text-surface-400 mb-4",children:h.message||"An unexpected error occurred"}),e.jsx("button",{onClick:()=>j(),className:"btn btn-primary",children:"Try Again"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-surface-100",children:"Runbooks"}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Step-by-step recovery procedures for systems and processes"})]}),e.jsxs(u,{to:"/bcdr/runbooks/new",className:"btn btn-primary",children:[e.jsx(_,{className:"w-5 h-5 mr-2"}),"Create Runbook"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Total Runbooks"}),o?e.jsx("div",{className:"h-8 w-16 bg-surface-700 rounded animate-pulse mt-1"}):e.jsx("p",{className:"text-2xl font-bold text-surface-100",children:d?.total||0})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Published"}),o?e.jsx("div",{className:"h-8 w-16 bg-surface-700 rounded animate-pulse mt-1"}):e.jsx("p",{className:"text-2xl font-bold text-green-400",children:d?.published_count||0})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Drafts"}),o?e.jsx("div",{className:"h-8 w-16 bg-surface-700 rounded animate-pulse mt-1"}):e.jsx("p",{className:"text-2xl font-bold text-surface-300",children:d?.draft_count||0})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("p",{className:"text-surface-400 text-sm",children:"Needs Review"}),o?e.jsx("div",{className:"h-8 w-16 bg-surface-700 rounded animate-pulse mt-1"}):e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:d?.needs_review_count||0})]})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-surface-400"}),e.jsx("input",{type:"text",placeholder:"Search runbooks...",className:"form-input pl-10 w-full",value:p,onChange:s=>b(s.target.value)})]})}),e.jsx("div",{className:"w-40",children:e.jsxs("select",{className:"form-select w-full",value:t,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"system_recovery",children:"System Recovery"}),e.jsx("option",{value:"data_restore",children:"Data Restore"}),e.jsx("option",{value:"failover",children:"Failover"}),e.jsx("option",{value:"communication",children:"Communication"}),e.jsx("option",{value:"network",children:"Network"}),e.jsx("option",{value:"security",children:"Security"})]})}),e.jsx("div",{className:"w-36",children:e.jsxs("select",{className:"form-select w-full",value:a,onChange:s=>v(s.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"needs_review",children:"Needs Review"})]})}),e.jsx("button",{onClick:()=>j(),className:"btn btn-secondary",children:e.jsx(S,{className:"w-5 h-5"})})]})}),y?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"card p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-surface-700 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-surface-700 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-surface-700 rounded w-2/3"})]},s))}):!m||m.length===0?e.jsxs("div",{className:"card p-8 text-center text-surface-400",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No runbooks found"}),e.jsx(u,{to:"/bcdr/runbooks/new",className:"text-brand-400 hover:text-brand-300 mt-2 inline-block",children:"Create your first runbook â†’"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(s=>e.jsxs(u,{to:`/bcdr/runbooks/${s.id}`,className:"card p-6 hover:border-brand-500/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:$[s.category]||"ðŸ“‹"}),e.jsx("span",{className:C("px-2 py-0.5 rounded text-xs font-medium",A[s.status]),children:s.status.replace("_"," ")})]}),e.jsxs("span",{className:"text-surface-400 text-xs",children:["v",s.version]})]}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-1",children:s.title}),e.jsx("p",{className:"text-surface-400 text-sm mb-3",children:s.runbook_id}),s.description&&e.jsx("p",{className:"text-surface-400 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.system_name&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"System"}),e.jsx("span",{className:"text-surface-300",children:s.system_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Steps"}),e.jsx("span",{className:"text-surface-300",children:s.step_count||0})]}),s.estimated_duration_minutes&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Duration"}),e.jsxs("span",{className:"text-surface-300 flex items-center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),s.estimated_duration_minutes,"m"]})]}),s.process_name&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Process"}),e.jsx("span",{className:"text-surface-300 truncate max-w-32",children:s.process_name})]})]})]},s.id))}),i>1&&e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>x(s=>Math.max(1,s-1)),disabled:r===1,className:"btn btn-secondary btn-sm",children:"Previous"}),e.jsxs("span",{className:"text-surface-400 text-sm",children:["Page ",r," of ",i]}),e.jsx("button",{onClick:()=>x(s=>Math.min(i,s+1)),disabled:r===i,className:"btn btn-secondary btn-sm",children:"Next"})]})]})}export{K as default};
