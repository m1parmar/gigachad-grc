import{u as K,r as c,b as A,c as o,j as e,ay as L,f,h as S,d as N,bF as v}from"./vendor-CWk44mA8.js";import{Q as i}from"./index-CiJwl-Bo.js";import{f as D}from"./vendor-date-CWdg4M78.js";import"./vendor-http-B9ygI19o.js";const I={info:"bg-blue-900/30 text-blue-400 border-blue-700",success:"bg-green-900/30 text-green-400 border-green-700",warning:"bg-amber-900/30 text-amber-400 border-amber-700",error:"bg-red-900/30 text-red-400 border-red-700"},Y={Controls:"ðŸŽ›ï¸",Evidence:"ðŸ“",Tasks:"âœ…",Policies:"ðŸ“‹",Integrations:"ðŸ”Œ",Collaboration:"ðŸ’¬",System:"âš™ï¸"};function G(){const l=K(),[r,x]=c.useState("all"),[B]=c.useState("all"),[m,g]=c.useState([]),[$,h]=c.useState(!1),{data:w,isLoading:R,refetch:F}=A({queryKey:["notifications","all",r],queryFn:()=>i.list({limit:50,unreadOnly:r==="unread"}),enabled:r!=="settings"}),u=w?.data?.notifications||[],p=w?.data?.unreadCount||0,{data:T,isLoading:q}=A({queryKey:["notifications","preferences"],queryFn:()=>i.getPreferences(),enabled:r==="settings"}),y=T?.data||[];c.useEffect(()=>{y.length>0&&m.length===0&&g(y)},[y]);const b=o({mutationFn:s=>i.updatePreferences(s.map(a=>({notificationType:a.notificationType,inApp:a.inApp,email:a.email}))),onSuccess:()=>{l.invalidateQueries({queryKey:["notifications","preferences"]}),h(!1)}}),P=o({mutationFn:()=>i.markAsRead(void 0,!0),onSuccess:()=>{l.invalidateQueries({queryKey:["notifications"]})}}),M=o({mutationFn:()=>i.deleteAll(),onSuccess:()=>{l.invalidateQueries({queryKey:["notifications"]})}}),Q=o({mutationFn:s=>i.delete(s),onSuccess:()=>{l.invalidateQueries({queryKey:["notifications"]})}}),O=o({mutationFn:s=>i.markOneAsRead(s),onSuccess:()=>{l.invalidateQueries({queryKey:["notifications"]})}}),C=(s,a,t)=>{g(n=>n.map(j=>j.notificationType===s?{...j,[a]:t}:j)),h(!0)},d=(s,a)=>{g(t=>t.map(n=>({...n,[s]:a}))),h(!0)},E=()=>{b.mutate(m)},k=m.reduce((s,a)=>(s[a.category]||(s[a.category]=[]),s[a.category].push(a),s),{});return[...Object.keys(k)],e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Notifications"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your notification preferences and view history"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[r!=="settings"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>F(),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Refresh",children:e.jsx(L,{className:"h-5 w-5"})}),p>0&&e.jsxs("button",{onClick:()=>P.mutate(),className:"px-3 py-2 text-sm text-indigo-400 hover:text-indigo-300 hover:bg-gray-700 rounded-lg transition-colors flex items-center space-x-1",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{children:"Mark all read"})]}),u.length>0&&e.jsxs("button",{onClick:()=>{confirm("Are you sure you want to delete all notifications?")&&M.mutate()},className:"px-3 py-2 text-sm text-red-400 hover:text-red-300 hover:bg-gray-700 rounded-lg transition-colors flex items-center space-x-1",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{children:"Clear all"})]})]}),r==="settings"&&$&&e.jsxs("button",{onClick:E,disabled:b.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{children:b.isPending?"Saving...":"Save Changes"})]})]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>x("all"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${r==="all"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500"}`,children:"All Notifications"}),e.jsxs("button",{onClick:()=>x("unread"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors flex items-center space-x-2 ${r==="unread"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500"}`,children:[e.jsx("span",{children:"Unread"}),p>0&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-indigo-600 text-white rounded-full",children:p})]}),e.jsx("button",{onClick:()=>x("settings"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${r==="settings"?"border-indigo-500 text-indigo-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-500"}`,children:"Settings"})]})}),r==="settings"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Quick Settings"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-gray-300 flex items-center space-x-2",children:[e.jsx(N,{className:"h-5 w-5"}),e.jsx("span",{children:"In-App"})]}),e.jsx("button",{onClick:()=>d("inApp",!0),className:"px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-500",children:"All On"}),e.jsx("button",{onClick:()=>d("inApp",!1),className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-500",children:"All Off"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-gray-300 flex items-center space-x-2",children:[e.jsx(v,{className:"h-5 w-5"}),e.jsx("span",{children:"Email"})]}),e.jsx("button",{onClick:()=>d("email",!0),className:"px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-500",children:"All On"}),e.jsx("button",{onClick:()=>d("email",!1),className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-500",children:"All Off"})]})]})]}),q?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-indigo-500 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading preferences..."})]}):Object.entries(k).map(([s,a])=>e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-gray-900 border-b border-gray-700",children:e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center space-x-2",children:[e.jsx("span",{children:Y[s]||"ðŸ“Œ"}),e.jsx("span",{children:s})]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:a.map(t=>e.jsxs("div",{className:"px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:t.typeName}),e.jsx("p",{className:"text-sm text-gray-400",children:t.description})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(N,{className:`h-5 w-5 ${t.inApp?"text-indigo-400":"text-gray-500"}`}),e.jsx("input",{type:"checkbox",checked:t.inApp,onChange:n=>C(t.notificationType,"inApp",n.target.checked),className:"sr-only"}),e.jsx("div",{className:`relative w-10 h-6 rounded-full transition-colors ${t.inApp?"bg-indigo-600":"bg-gray-600"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${t.inApp?"translate-x-4":"translate-x-0"}`})})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(v,{className:`h-5 w-5 ${t.email?"text-indigo-400":"text-gray-500"}`}),e.jsx("input",{type:"checkbox",checked:t.email,onChange:n=>C(t.notificationType,"email",n.target.checked),className:"sr-only"}),e.jsx("div",{className:`relative w-10 h-6 rounded-full transition-colors ${t.email?"bg-indigo-600":"bg-gray-600"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${t.email?"translate-x-4":"translate-x-0"}`})})]})]})]},t.notificationType))})]},s)),e.jsx("div",{className:"bg-amber-900/20 border border-amber-700 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(v,{className:"h-6 w-6 text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-amber-400 font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Email notifications are currently in placeholder mode. Configure your email provider in the settings to enable email delivery."})]})]})})]}):e.jsx("div",{className:"space-y-4",children:R?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-indigo-500 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading notifications..."})]}):u.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-800 rounded-xl border border-gray-700",children:[e.jsx(N,{className:"h-16 w-16 mx-auto text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white",children:"No notifications"}),e.jsx("p",{className:"text-gray-400 mt-1",children:r==="unread"?"You're all caught up!":"You haven't received any notifications yet."})]}):e.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 divide-y divide-gray-700 overflow-hidden",children:u.map(s=>e.jsx("div",{className:`p-4 hover:bg-gray-700/50 transition-colors ${s.isRead?"":"bg-gray-700/30"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:`px-2.5 py-1 rounded-lg border text-xs font-medium ${I[s.severity]}`,children:s.severity}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:`text-sm font-medium ${s.isRead?"text-gray-300":"text-white"}`,children:s.title}),!s.isRead&&e.jsx("span",{className:"h-2 w-2 bg-indigo-500 rounded-full"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.message}),e.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:D(new Date(s.createdAt),{addSuffix:!0})}),s.entityType&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-700 px-2 py-0.5 rounded",children:s.entityType})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[!s.isRead&&e.jsx("button",{onClick:()=>O.mutate(s.id),className:"p-2 text-gray-400 hover:text-green-400 hover:bg-gray-700 rounded-lg transition-colors",title:"Mark as read",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Q.mutate(s.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-gray-700 rounded-lg transition-colors",title:"Delete",children:e.jsx(S,{className:"h-4 w-4"})})]})]})},s.id))})})]})}export{G as default};
