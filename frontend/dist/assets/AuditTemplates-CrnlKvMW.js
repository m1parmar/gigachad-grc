import{u as w,r as o,b as y,c as m,j as e,M as N,q as u,S as b,L as v,a3 as T,h as C}from"./vendor-CWk44mA8.js";import{B as r}from"./index-CiJwl-Bo.js";import{u as S}from"./useToast-oJzujiun.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const x={internal:"Internal",external:"External",surveillance:"Surveillance",certification:"Certification"};function L(){const i=w(),l=S(),[a,p]=o.useState(""),[k,h]=o.useState(!1),{data:c=[],isLoading:n}=y({queryKey:["audit-templates",a],queryFn:async()=>{const s=new URLSearchParams;a&&s.set("auditType",a);const t=await fetch(`/api/audit/templates?${s}`);if(!t.ok)throw new Error("Failed to fetch templates");return t.json()}}),f=m({mutationFn:async({id:s,name:t})=>{const d=await fetch(`/api/audit/templates/${s}/clone`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})});if(!d.ok)throw new Error("Failed to clone template");return d.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["audit-templates"]}),l.success("Template cloned successfully")}}),j=m({mutationFn:async s=>{const t=await fetch(`/api/audit/templates/${s}`,{method:"DELETE"});if(!t.ok)throw new Error("Failed to delete template");return t.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["audit-templates"]}),l.success("Template archived")}}),g=s=>{const t=prompt("Enter name for the new template:",`${s.name} (Copy)`);t&&f.mutate({id:s.id,name:t})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Audit Templates"}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Reusable templates with checklists and request templates"})]}),e.jsxs(r,{onClick:()=>h(!0),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"New Template"]})]}),e.jsx("div",{className:"flex gap-4",children:e.jsxs("select",{value:a,onChange:s=>p(s.target.value),className:"bg-surface-800 border border-surface-600 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"",children:"All Types"}),Object.entries(x).map(([s,t])=>e.jsx("option",{value:s,children:t},s))]})}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"animate-pulse bg-surface-800 rounded-lg p-6 h-48"},s))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(s=>e.jsxs("div",{className:"bg-surface-800 rounded-lg p-6 border border-surface-700 hover:border-surface-500 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-brand-500/10 rounded-lg",children:e.jsx(u,{className:"h-6 w-6 text-brand-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:s.name}),s.isSystem&&e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"System Template"})]})]})}),e.jsx("p",{className:"text-surface-400 text-sm mt-3 line-clamp-2",children:s.description||"No description"}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[e.jsx("span",{className:"bg-surface-700 text-surface-300 px-2 py-1 rounded",children:x[s.auditType]||s.auditType}),s.framework&&e.jsx("span",{className:"bg-surface-700 text-surface-300 px-2 py-1 rounded",children:s.framework})]}),e.jsx("div",{className:"mt-4 flex items-center justify-between text-sm text-surface-400",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"h-4 w-4"}),s.checklistItems?.length||0," items"]}),e.jsxs("span",{children:[s.usageCount," uses"]})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-surface-700 flex gap-2",children:[e.jsx(v,{to:`/audits/new?templateId=${s.id}`,className:"flex-1",children:e.jsx(r,{variant:"primary",size:"sm",className:"w-full",children:"Use Template"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>g(s),title:"Clone Template",children:e.jsx(T,{className:"h-4 w-4"})}),!s.isSystem&&e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>j.mutate(s.id),title:"Archive Template",children:e.jsx(C,{className:"h-4 w-4 text-red-400"})})]})]},s.id))}),!n&&c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(u,{className:"h-12 w-12 text-surface-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white",children:"No templates found"}),e.jsx("p",{className:"text-surface-400 mt-2",children:"Create a new template or check back later for system templates."})]})]})}export{L as default};
