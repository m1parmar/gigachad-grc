import{b as p,j as e,y as g,S as j,E as h,X as f,aa as b,by as y,B as N}from"./vendor-CWk44mA8.js";import{b as v,q as w,G as C}from"./index-CiJwl-Bo.js";import{L as u}from"./LazyCharts-CLuWtu1O.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";function q(){const{user:i}=v(),r=i?.organizationId||"default-org",{data:a,isLoading:d}=p({queryKey:["questionnaire-analytics",r],queryFn:async()=>(await w.getAnalytics(r)).data}),{data:n}=p({queryKey:["kb-stats",r],queryFn:async()=>(await C.getStats(r)).data});if(d)return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-8 bg-surface-700 rounded w-48 animate-pulse"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(s=>e.jsx("div",{className:"h-32 bg-surface-800 rounded-xl animate-pulse"},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-80 bg-surface-800 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-80 bg-surface-800 rounded-xl animate-pulse"})]})]});const l=a?.summary||{totalQuestionnaires:0,completedQuestionnaires:0,completionRate:0,avgQuestionsPerQuestionnaire:0,totalQuestions:0},m={pending:"#F59E0B",answered:"#10B981",approved:"#3B82F6",in_progress:"#6366F1",rejected:"#EF4444"},x={urgent:"#EF4444",high:"#F97316",medium:"#F59E0B",low:"#6B7280"};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-surface-100",children:"Trust Analytics"}),e.jsx("p",{className:"mt-1 text-surface-400",children:"Insights into questionnaire performance and knowledge base usage"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(c,{title:"Total Questionnaires",value:l.totalQuestionnaires,icon:g,color:"blue"}),e.jsx(c,{title:"Completion Rate",value:`${l.completionRate}%`,icon:j,color:"green",subtitle:`${l.completedQuestionnaires} completed`}),e.jsx(c,{title:"Total Questions",value:l.totalQuestions,icon:h,color:"purple",subtitle:`~${l.avgQuestionsPerQuestionnaire} per questionnaire`}),e.jsx(c,{title:"KB Entries",value:n?.total||0,icon:f,color:"amber",subtitle:`${n?.approved||0} approved`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Questions by Status"}),e.jsx(u,{height:250,children:s=>a?.questionsByStatus?e.jsx(s.ResponsiveContainer,{width:"100%",height:250,children:e.jsxs(s.PieChart,{children:[e.jsx(s.Pie,{data:a.questionsByStatus.map(t=>({name:t.status.charAt(0).toUpperCase()+t.status.slice(1).replace("_"," "),value:t.count})),cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",label:({name:t,value:o})=>`${t}: ${o}`,children:a.questionsByStatus.map((t,o)=>e.jsx(s.Cell,{fill:m[t.status]||"#6B7280"},`cell-${o}`))}),e.jsx(s.Tooltip,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}})]})}):null}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4 mt-4",children:a?.questionsByStatus?.map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:m[s.status]||"#6B7280"}}),e.jsx("span",{className:"text-surface-300 capitalize",children:s.status.replace("_"," ")})]},s.status))})]}),e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-4",children:"Questionnaires by Priority"}),e.jsx(u,{height:250,children:s=>a?.questionnairesByPriority?e.jsx(s.ResponsiveContainer,{width:"100%",height:250,children:e.jsxs(s.BarChart,{data:a.questionnairesByPriority.map(t=>({name:t.priority.charAt(0).toUpperCase()+t.priority.slice(1),count:t.count,fill:x[t.priority]||"#6B7280"})),layout:"vertical",margin:{left:60,right:20},children:[e.jsx(s.CartesianGrid,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(s.XAxis,{type:"number",stroke:"#9CA3AF"}),e.jsx(s.YAxis,{type:"category",dataKey:"name",stroke:"#9CA3AF"}),e.jsx(s.Tooltip,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(s.Bar,{dataKey:"count",radius:[0,4,4,0],children:a.questionnairesByPriority.map((t,o)=>e.jsx(s.Cell,{fill:x[t.priority]||"#6B7280"},`cell-${o}`))})]})}):null})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"w-5 h-5 text-surface-400"}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:"Average Response Time"})]}),e.jsx("div",{className:"space-y-4",children:a?.responseTimeByPriority?.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x[s.priority]||"#6B7280"}}),e.jsx("span",{className:"text-surface-200 capitalize",children:s.priority})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-surface-100 font-semibold",children:B(s.avgHours)}),e.jsxs("span",{className:"text-xs text-surface-500 ml-2",children:["(",s.count," completed)"]})]})]},s.priority))||e.jsx("p",{className:"text-surface-400 text-sm",children:"No completion data available"})})]}),e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{className:"w-5 h-5 text-surface-400"}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:"Completion Trend"})]}),e.jsx(u,{height:200,children:s=>a?.completionTrend&&a.completionTrend.length>0?e.jsx(s.ResponsiveContainer,{width:"100%",height:200,children:e.jsxs(s.AreaChart,{data:a.completionTrend.map(t=>({week:new Date(t.week).toLocaleDateString("en-US",{month:"short",day:"numeric"}),completions:t.count})),margin:{left:0,right:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCompletions",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})}),e.jsx(s.CartesianGrid,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(s.XAxis,{dataKey:"week",stroke:"#9CA3AF",fontSize:12}),e.jsx(s.YAxis,{stroke:"#9CA3AF",fontSize:12}),e.jsx(s.Tooltip,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(s.Area,{type:"monotone",dataKey:"completions",stroke:"#10B981",fillOpacity:1,fill:"url(#colorCompletions)"})]})}):e.jsx("div",{className:"h-[200px] flex items-center justify-center text-surface-400 text-sm",children:"No completion data for this period"})})]})]}),e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(f,{className:"w-5 h-5 text-surface-400"}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:"Most Used Knowledge Base Entries"})]}),a?.topKbEntries&&a.topKbEntries.length>0?e.jsx("div",{className:"divide-y divide-surface-700",children:a.topKbEntries.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-surface-700 text-surface-400 text-sm font-bold rounded",children:t+1}),e.jsxs("div",{children:[e.jsx("p",{className:"text-surface-100 font-medium",children:s.title}),s.category&&e.jsx("span",{className:"text-xs text-surface-500 capitalize",children:s.category})]})]}),e.jsxs("span",{className:"text-surface-400 text-sm",children:[s.usageCount," uses"]})]},s.id))}):e.jsx("p",{className:"text-surface-400 text-sm",children:"No usage data available yet"})]})]})}function B(i){if(i<24)return`${i}h`;const r=Math.floor(i/24),a=i%24;return a===0?`${r}d`:`${r}d ${a}h`}function c({title:i,value:r,icon:a,color:d,subtitle:n}){const l={blue:"bg-blue-500/20 text-blue-400",green:"bg-green-500/20 text-green-400",purple:"bg-purple-500/20 text-purple-400",amber:"bg-amber-500/20 text-amber-400",red:"bg-red-500/20 text-red-400"};return e.jsxs("div",{className:"bg-surface-900 border border-surface-800 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:N("p-2 rounded-lg",l[d]),children:e.jsx(a,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-sm text-surface-400",children:i})]}),e.jsx("p",{className:"text-3xl font-bold text-surface-100",children:r}),n&&e.jsx("p",{className:"text-xs text-surface-500 mt-1",children:n})]})}export{q as default};
