import{r as x,b as f,j as e,bT as C,B as i,J as u,L as l,M as R,l as S,ay as k,cg as $,bF as E,a9 as N}from"./vendor-CWk44mA8.js";import{d as g}from"./index-CiJwl-Bo.js";import{u as L}from"./useDebounce-BWtFJvQ9.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const y={emergency:"Emergency",crisis:"Crisis",incident:"Incident",stakeholder:"Stakeholder"},T={internal:"bg-blue-500/20 text-blue-400",vendor:"bg-purple-500/20 text-purple-400",customer:"bg-green-500/20 text-green-400",regulatory:"bg-orange-500/20 text-orange-400",emergency_services:"bg-red-500/20 text-red-400",media:"bg-yellow-500/20 text-yellow-400",other:"bg-surface-600 text-surface-300"};function z(){const[p,v]=x.useState(""),[c,w]=x.useState(""),[r,_]=x.useState(!1),d=L(p,300),{data:m,isLoading:F,error:h,refetch:b}=f({queryKey:["communication-plans",d,c],queryFn:async()=>{const s=new URLSearchParams;return d&&s.append("search",d),c&&s.append("planType",c),(await g.get(`/api/bcdr/communication?${s}`)).data},retry:1}),o=Array.isArray(m)?m:m?.data??[],{data:n,error:j}=f({queryKey:["escalation-contacts"],queryFn:async()=>(await g.get("/api/bcdr/communication/escalation")).data,enabled:r,retry:1});return h&&!r?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(C,{className:"w-12 h-12 mx-auto mb-4 text-red-400"}),e.jsx("h2",{className:"text-lg font-semibold text-surface-100 mb-2",children:"Failed to load Communication Plans"}),e.jsx("p",{className:"text-surface-400 mb-4",children:h.message||"An unexpected error occurred"}),e.jsx("button",{onClick:()=>b(),className:"btn btn-primary",children:"Try Again"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-surface-100",children:"Communication Plans"}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Emergency contact lists and communication protocols"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>_(!r),className:i("btn btn-secondary",r&&"bg-brand-600 border-brand-600"),children:[e.jsx(u,{className:"w-5 h-5 mr-2"}),"Escalation View"]}),e.jsxs(l,{to:"/bcdr/communication/new",className:"btn btn-primary",children:[e.jsx(R,{className:"w-5 h-5 mr-2"}),"Create Plan"]})]})]}),!r&&e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-surface-400"}),e.jsx("input",{type:"text",placeholder:"Search plans...",className:"form-input pl-10 w-full",value:p,onChange:s=>v(s.target.value)})]})}),e.jsx("div",{className:"w-40",children:e.jsxs("select",{className:"form-select w-full",value:c,onChange:s=>w(s.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),Object.entries(y).map(([s,t])=>e.jsx("option",{value:s,children:t},s))]})}),e.jsx("button",{onClick:()=>b(),className:"btn btn-secondary",children:e.jsx(k,{className:"w-5 h-5"})})]})}),r?e.jsxs("div",{className:"space-y-6",children:[j&&e.jsxs("div",{className:"card p-4 border border-red-500/50 bg-red-500/10 text-sm text-red-300",children:["Failed to load escalation contacts. ",j.message||""]}),n&&Object.entries(n).sort(([s],[t])=>Number(s)-Number(t)).map(([s,t])=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:i("w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg",Number(s)===1?"bg-red-500/20 text-red-400":Number(s)===2?"bg-orange-500/20 text-orange-400":"bg-yellow-500/20 text-yellow-400"),children:["L",s]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-surface-100",children:["Level ",s," Contacts"]}),e.jsx("p",{className:"text-surface-400 text-sm",children:Number(s)===1?"First responders":Number(s)===2?"Secondary escalation":"Management escalation"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(a=>e.jsxs("div",{className:"p-4 rounded-lg bg-surface-800/50 border border-surface-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-surface-100 font-medium",children:a.name}),a.title&&e.jsx("p",{className:"text-surface-400 text-sm",children:a.title})]}),e.jsx("span",{className:i("px-2 py-0.5 rounded text-xs font-medium",T[a.contact_type]),children:a.contact_type})]}),a.organization_name&&e.jsx("p",{className:"text-surface-400 text-xs mb-2",children:a.organization_name}),e.jsxs("div",{className:"space-y-1 text-sm",children:[a.primary_phone&&e.jsxs("div",{className:"flex items-center gap-2 text-surface-300",children:[e.jsx($,{className:"w-4 h-4 text-surface-400"}),a.primary_phone]}),a.email&&e.jsxs("div",{className:"flex items-center gap-2 text-surface-300",children:[e.jsx(E,{className:"w-4 h-4 text-surface-400"}),a.email]})]}),a.role_in_plan&&e.jsxs("p",{className:"text-surface-500 text-xs mt-2 pt-2 border-t border-surface-700",children:["Role: ",a.role_in_plan]})]},a.id))})]},s)),(!n||Object.keys(n).length===0)&&e.jsxs("div",{className:"card p-8 text-center text-surface-400",children:[e.jsx(u,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No escalation contacts configured"}),e.jsx(l,{to:"/bcdr/communication/new",className:"text-brand-400 hover:text-brand-300 mt-2 inline-block",children:"Create a communication plan →"})]})]}):e.jsx(e.Fragment,{children:F?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"card p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-surface-700 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-surface-700 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-surface-700 rounded w-2/3"})]},s))}):!o||o.length===0?e.jsxs("div",{className:"card p-8 text-center text-surface-400",children:[e.jsx(N,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No communication plans found"}),e.jsx(l,{to:"/bcdr/communication/new",className:"text-brand-400 hover:text-brand-300 mt-2 inline-block",children:"Create your first plan →"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(s=>e.jsxs(l,{to:`/bcdr/communication/${s.id}`,className:"card p-6 hover:border-brand-500/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-brand-400"}),e.jsx("span",{className:i("px-2 py-0.5 rounded text-xs font-medium",s.is_active?"bg-green-500/20 text-green-400":"bg-surface-600 text-surface-400"),children:s.is_active?"Active":"Inactive"})]}),e.jsx("span",{className:"px-2 py-0.5 rounded bg-surface-700 text-surface-300 text-xs",children:y[s.plan_type]||s.plan_type})]}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100 mb-1",children:s.name}),s.description&&e.jsx("p",{className:"text-surface-400 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Contacts"}),e.jsxs("span",{className:"text-surface-300 flex items-center gap-1",children:[e.jsx(u,{className:"w-4 h-4"}),s.contact_count||0]})]}),s.bcdr_plan_title&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-surface-400",children:"Linked Plan"}),e.jsx("span",{className:"text-surface-300 truncate max-w-32",children:s.bcdr_plan_title})]})]})]},s.id))})})]})}export{z as default};
