import{u as T,b as w,c as $,I as p,A as h,aa as k,af as D,bX as C,j as e,v as S,L as l,g as N,ay as F,p as B,E as A,S as E,aZ as b}from"./vendor-CWk44mA8.js";import{O as f}from"./index-CiJwl-Bo.js";import{a as M,f as I}from"./Skeleton-DVOICtGK.js";import{u as L}from"./useToast-oJzujiun.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const P={totalEmployees:0,averageScore:0,complianceRate:0,scoreDistribution:{compliant:0,atRisk:0,nonCompliant:0},issueBreakdown:{overdueTrainings:0,missingBackgroundChecks:0,pendingAttestations:0,mfaNotEnabled:0,nonCompliantDevices:0},departmentStats:[],upcomingDeadlines:{expiringBackgroundChecks:[],overdueTrainings:[],pendingAttestations:[]},dataCoverage:{hris:0,backgroundCheck:0,training:0,assets:0,access:0}};function g({title:o,value:r,subtitle:t,icon:n,color:d,isLoading:i=!1}){return i?e.jsx("div",{className:"card p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-24 bg-surface-700 rounded"}),e.jsx("div",{className:"h-8 w-16 bg-surface-700 rounded"}),e.jsx("div",{className:"h-3 w-20 bg-surface-700 rounded"})]}),e.jsx("div",{className:"p-3 rounded-lg bg-surface-700 h-12 w-12"})]})}):e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:o}),e.jsx("p",{className:`text-3xl font-bold ${d}`,children:r}),t&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t})]}),e.jsx("div",{className:"p-3 rounded-lg bg-surface-700",children:e.jsx(n,{className:`h-6 w-6 ${d}`})})]})})}function j({range:o,count:r,total:t,color:n}){const d=t>0?r/t*100:0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-24",children:o}),e.jsx("div",{className:"flex-1 h-6 bg-surface-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${n} rounded-full transition-all duration-500`,style:{width:`${d}%`}})}),e.jsx("span",{className:"text-sm text-foreground w-10 text-right",children:r})]})}function m({label:o,percentage:r,icon:t,color:n}){return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t,{className:`h-5 w-5 ${n}`}),e.jsx("span",{className:"text-sm text-muted-foreground w-32",children:o}),e.jsx("div",{className:"flex-1 h-2 bg-surface-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${r>=90?"bg-green-500":r>=70?"bg-yellow-500":"bg-red-500"} rounded-full transition-all duration-500`,style:{width:`${r}%`}})}),e.jsxs("span",{className:"text-sm text-foreground w-12 text-right",children:[r,"%"]})]})}function R({message:o,icon:r}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(r,{className:"h-12 w-12 text-surface-500 mb-3"}),e.jsx("p",{className:"text-surface-400",children:o}),e.jsxs(l,{to:"/settings/employee-compliance",className:"text-brand-400 hover:text-brand-300 mt-2 text-sm flex items-center gap-1",children:[e.jsx(N,{className:"h-4 w-4"}),"Configure Integrations"]})]})}function U(){const o=T(),r=L(),{data:t,isLoading:n,error:d}=w({queryKey:["employee-compliance-dashboard"],queryFn:async()=>(await f.getDashboard()).data,refetchInterval:6e4}),{data:i}=w({queryKey:["employee-compliance-missing"],queryFn:async()=>(await f.getMissingData()).data}),x=$({mutationFn:()=>f.triggerSync(),onSuccess:()=>{r.success("Sync initiated. Data will be refreshed shortly."),o.invalidateQueries({queryKey:["employee-compliance-dashboard"]}),o.invalidateQueries({queryKey:["employee-compliance-missing"]})},onError:()=>{r.error("Failed to initiate sync. Please try again.")}}),s=t?{totalEmployees:t.totalEmployees||0,averageScore:Math.round(t.averageScore||0),complianceRate:Math.round(t.complianceRate||0),scoreDistribution:{compliant:t.scoreDistribution?.compliant||0,atRisk:t.scoreDistribution?.atRisk||0,nonCompliant:t.scoreDistribution?.nonCompliant||0},issueBreakdown:{overdueTrainings:t.issueBreakdown?.overdueTrainings||0,missingBackgroundChecks:t.issueBreakdown?.missingBackgroundChecks||0,pendingAttestations:t.issueBreakdown?.pendingAttestations||0,mfaNotEnabled:t.issueBreakdown?.mfaNotEnabled||0,nonCompliantDevices:t.issueBreakdown?.nonCompliantDevices||0},departmentStats:t.departmentStats||[],upcomingDeadlines:t.upcomingDeadlines||{expiringBackgroundChecks:[],overdueTrainings:[],pendingAttestations:[]},dataCoverage:{hris:t.dataCoverage?.hris||0,backgroundCheck:t.dataCoverage?.backgroundCheck||0,training:t.dataCoverage?.training||0,assets:t.dataCoverage?.assets||0,access:t.dataCoverage?.access||0}}:P,v=[{type:"training",count:s.issueBreakdown.overdueTrainings,label:"Training Overdue",icon:p,color:"text-purple-400"},{type:"background_check",count:s.issueBreakdown.missingBackgroundChecks,label:"Missing Background Check",icon:h,color:"text-green-400"},{type:"attestation",count:s.issueBreakdown.pendingAttestations,label:"Pending Attestations",icon:k,color:"text-yellow-400"},{type:"mfa",count:s.issueBreakdown.mfaNotEnabled,label:"MFA Not Enabled",icon:D,color:"text-cyan-400"},{type:"device",count:s.issueBreakdown.nonCompliantDevices,label:"Non-Compliant Devices",icon:C,color:"text-orange-400"}],y=v.reduce((a,c)=>a+c.count,0),u=s.totalEmployees>0;return d?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(S,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Unable to Load Dashboard"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"There was an error loading the employee compliance dashboard. Please try again later."}),e.jsx("button",{onClick:()=>o.invalidateQueries({queryKey:["employee-compliance-dashboard"]}),className:"btn btn-primary",children:"Retry"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Employee Compliance Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Overview of employee compliance across all systems"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l,{to:"/settings/employee-compliance",className:"btn btn-secondary",children:[e.jsx(N,{className:"h-5 w-5"}),"Settings"]}),e.jsxs("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"btn btn-secondary",children:[e.jsx(F,{className:`h-5 w-5 ${x.isPending?"animate-spin":""}`}),x.isPending?"Syncing...":"Sync All"]}),e.jsx(l,{to:"/employees",className:"btn btn-primary",children:"View All Employees"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(g,{title:"Total Employees",value:s.totalEmployees,subtitle:"Active employees",icon:B,color:"text-blue-400",isLoading:n}),e.jsx(g,{title:"Average Score",value:s.averageScore,subtitle:"Out of 100",icon:A,color:s.averageScore>=80?"text-green-400":s.averageScore>=60?"text-yellow-400":"text-red-400",isLoading:n}),e.jsx(g,{title:"Compliance Rate",value:`${s.complianceRate}%`,subtitle:"Score ≥ 80",icon:E,color:"text-green-400",isLoading:n}),e.jsx(g,{title:"Issues Found",value:y,subtitle:"Across all categories",icon:S,color:"text-orange-400",isLoading:n})]}),!n&&!u&&e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(B,{className:"h-16 w-16 text-surface-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No Employee Data Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4 max-w-md mx-auto",children:"Connect your HRIS, background check, training, and MDM integrations to start tracking employee compliance."}),e.jsxs(l,{to:"/settings/employee-compliance",className:"btn btn-primary",children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Configure Data Sources"]})]}),(n||u)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Score Distribution"}),n?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(a=>e.jsx("div",{className:"h-6 bg-surface-700 rounded animate-pulse"},a))}):u?e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{range:"Compliant (≥80)",count:s.scoreDistribution.compliant,total:s.totalEmployees,color:"bg-green-500"}),e.jsx(j,{range:"At Risk (60-79)",count:s.scoreDistribution.atRisk,total:s.totalEmployees,color:"bg-yellow-500"}),e.jsx(j,{range:"Non-Compliant (<60)",count:s.scoreDistribution.nonCompliant,total:s.totalEmployees,color:"bg-red-500"})]}):e.jsx(R,{message:"No score data available",icon:A})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Issue Breakdown"}),n?e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(a=>e.jsx("div",{className:"h-12 bg-surface-700 rounded animate-pulse"},a))}):y===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(E,{className:"h-12 w-12 text-green-500 mb-3"}),e.jsx("p",{className:"text-green-400 font-medium",children:"All Clear!"}),e.jsx("p",{className:"text-surface-400 text-sm",children:"No compliance issues detected"})]}):e.jsx("div",{className:"space-y-3",children:v.filter(a=>a.count>0).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-700/50 rounded-lg hover:bg-surface-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.icon,{className:`h-5 w-5 ${a.color}`}),e.jsx("span",{className:"text-foreground",children:a.label})]}),e.jsx("span",{className:"text-lg font-semibold text-foreground",children:a.count})]},a.type))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Compliance by Department"}),n?e.jsx(M,{rows:5,columns:3}):s.departmentStats.length===0?e.jsx(R,{message:"No department data available",icon:b}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left p-2 font-medium text-muted-foreground",children:"Department"}),e.jsx("th",{className:"text-center p-2 font-medium text-muted-foreground",children:"Employees"}),e.jsx("th",{className:"text-center p-2 font-medium text-muted-foreground",children:"Avg Score"})]})}),e.jsx("tbody",{children:s.departmentStats.map(a=>e.jsxs("tr",{className:"border-b border-border hover:bg-surface-700/30 transition-colors",children:[e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-foreground",children:a.department})]})}),e.jsx("td",{className:"p-2 text-center text-muted-foreground",children:a.employeeCount}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:`font-semibold ${a.averageScore>=80?"text-green-400":a.averageScore>=60?"text-yellow-400":"text-red-400"}`,children:a.averageScore})})]},a.department))})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Data Coverage"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Percentage of employees with data from each integration type"}),n?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(a=>e.jsx("div",{className:"h-5 bg-surface-700 rounded animate-pulse"},a))}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{label:"HRIS",percentage:s.dataCoverage.hris,icon:b,color:"text-blue-400"}),e.jsx(m,{label:"Background Check",percentage:s.dataCoverage.backgroundCheck,icon:h,color:"text-green-400"}),e.jsx(m,{label:"Training (LMS)",percentage:s.dataCoverage.training,icon:p,color:"text-purple-400"}),e.jsx(m,{label:"Assets (MDM)",percentage:s.dataCoverage.assets,icon:C,color:"text-orange-400"}),e.jsx(m,{label:"Access (IdP)",percentage:s.dataCoverage.access,icon:D,color:"text-cyan-400"})]}),i&&(i.noBackgroundCheck?.length>0||i.noTrainingData?.length>0||i.noDeviceData?.length>0||i.noAccessData?.length>0)&&e.jsxs("div",{className:"mt-4 p-3 bg-amber-50 dark:bg-yellow-500/10 border border-amber-300 dark:border-yellow-500/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-amber-700 dark:text-yellow-400 font-medium mb-1",children:"Missing Data Detected"}),e.jsxs("p",{className:"text-xs text-amber-600 dark:text-yellow-400/80",children:[i.noBackgroundCheck?.length||0," employees missing background checks, "," ",i.noTrainingData?.length||0," missing training data"]}),e.jsx(l,{to:"/employees?filter=missing-data",className:"text-xs text-amber-700 dark:text-yellow-300 hover:text-amber-800 dark:hover:text-yellow-200 mt-1 inline-block",children:"View details →"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Upcoming Deadlines & Issues"}),n?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(a=>e.jsx(I,{},a))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(p,{className:"h-5 w-5 text-red-400"}),e.jsx("span",{className:"font-medium text-foreground",children:"Overdue Trainings"}),s.upcomingDeadlines.overdueTrainings.length>0&&e.jsx("span",{className:"ml-auto bg-red-500/20 text-red-400 px-2 py-0.5 rounded-full text-xs",children:s.upcomingDeadlines.overdueTrainings.length})]}),s.upcomingDeadlines.overdueTrainings.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No overdue trainings"}):e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[s.upcomingDeadlines.overdueTrainings.slice(0,5).map((a,c)=>e.jsxs("div",{className:"text-sm p-2 bg-surface-700/30 rounded hover:bg-surface-700/50 transition-colors",children:[e.jsx("p",{className:"text-foreground font-medium",children:a.employeeName||a.employeeEmail}),e.jsx("p",{className:"text-muted-foreground text-xs",children:a.details?.courseName||"Training course"}),e.jsxs("p",{className:"text-red-400 text-xs",children:["Due: ",new Date(a.deadline).toLocaleDateString()]})]},c)),s.upcomingDeadlines.overdueTrainings.length>5&&e.jsxs(l,{to:"/employees?filter=overdue-training",className:"text-xs text-brand-400 hover:text-brand-300 block text-center mt-2",children:["View all ",s.upcomingDeadlines.overdueTrainings.length," →"]})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(h,{className:"h-5 w-5 text-yellow-400"}),e.jsx("span",{className:"font-medium text-foreground",children:"Expiring Background Checks"}),s.upcomingDeadlines.expiringBackgroundChecks.length>0&&e.jsx("span",{className:"ml-auto bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded-full text-xs",children:s.upcomingDeadlines.expiringBackgroundChecks.length})]}),s.upcomingDeadlines.expiringBackgroundChecks.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No expiring checks"}):e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[s.upcomingDeadlines.expiringBackgroundChecks.slice(0,5).map((a,c)=>e.jsxs("div",{className:"text-sm p-2 bg-surface-700/30 rounded hover:bg-surface-700/50 transition-colors",children:[e.jsx("p",{className:"text-foreground font-medium",children:a.employeeName||a.employeeEmail}),e.jsxs("p",{className:"text-muted-foreground text-xs capitalize",children:[a.details?.checkType||"Background"," check"]}),e.jsxs("p",{className:"text-yellow-400 text-xs",children:["Expires: ",new Date(a.deadline).toLocaleDateString()]})]},c)),s.upcomingDeadlines.expiringBackgroundChecks.length>5&&e.jsxs(l,{to:"/employees?filter=expiring-background",className:"text-xs text-brand-400 hover:text-brand-300 block text-center mt-2",children:["View all ",s.upcomingDeadlines.expiringBackgroundChecks.length," →"]})]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(k,{className:"h-5 w-5 text-blue-400"}),e.jsx("span",{className:"font-medium text-foreground",children:"Pending Attestations"}),s.upcomingDeadlines.pendingAttestations.length>0&&e.jsx("span",{className:"ml-auto bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded-full text-xs",children:s.upcomingDeadlines.pendingAttestations.length})]}),s.upcomingDeadlines.pendingAttestations.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No pending attestations"}):e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[s.upcomingDeadlines.pendingAttestations.slice(0,5).map((a,c)=>e.jsxs("div",{className:"text-sm p-2 bg-surface-700/30 rounded hover:bg-surface-700/50 transition-colors",children:[e.jsx("p",{className:"text-foreground font-medium",children:a.employeeName||a.employeeEmail}),e.jsx("p",{className:"text-muted-foreground text-xs",children:a.details?.policyTitle||"Policy attestation"}),e.jsxs("p",{className:"text-blue-400 text-xs",children:["Requested: ",new Date(a.deadline).toLocaleDateString()]})]},c)),s.upcomingDeadlines.pendingAttestations.length>5&&e.jsxs(l,{to:"/employees?filter=pending-attestation",className:"text-xs text-brand-400 hover:text-brand-300 block text-center mt-2",children:["View all ",s.upcomingDeadlines.pendingAttestations.length," →"]})]})]})]})]})]})]})}export{U as default};
