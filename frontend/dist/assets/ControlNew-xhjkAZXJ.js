import{k as j,u as f,r as o,c as y,j as e,L as C,aO as N,aD as m}from"./vendor-CWk44mA8.js";import{B as x,e as I}from"./index-CiJwl-Bo.js";import"./vendor-http-B9ygI19o.js";import"./vendor-date-CWdg4M78.js";const S=[{value:"access_control",label:"Access Control"},{value:"data_protection",label:"Data Protection"},{value:"security_operations",label:"Security Operations"},{value:"network_security",label:"Network Security"},{value:"application_security",label:"Application Security"},{value:"physical_security",label:"Physical Security"},{value:"incident_response",label:"Incident Response"},{value:"business_continuity",label:"Business Continuity"},{value:"compliance",label:"Compliance"},{value:"governance",label:"Governance"}];function _(){const d=j(),p=f(),[a,h]=o.useState({controlId:"",title:"",description:"",category:"access_control",tags:[]}),[c,b]=o.useState(""),[s,u]=o.useState({}),i=y({mutationFn:t=>I.create(t),onSuccess:t=>{p.invalidateQueries({queryKey:["controls"]}),m.success("Control created successfully"),d(`/controls/${t.data.id}`)},onError:t=>{const r=t.response?.data?.message||"Failed to create control";m.error(r)}}),v=()=>{const t={};return a.controlId.trim()||(t.controlId="Control ID is required"),a.title.trim()||(t.title="Title is required"),a.description.trim()||(t.description="Description is required"),u(t),Object.keys(t).length===0},g=t=>{if(t.preventDefault(),!v())return;const r={...a,tags:c?c.split(",").map(l=>l.trim()).filter(Boolean):[]};i.mutate(r)},n=(t,r)=>{h(l=>({...l,[t]:r})),s[t]&&u(l=>({...l,[t]:""}))};return e.jsxs("div",{className:"max-w-3xl mx-auto space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsxs(C,{to:"/controls",className:"inline-flex items-center text-sm text-surface-400 hover:text-surface-100 mb-4",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Back to Controls"]}),e.jsx("h1",{className:"text-2xl font-bold text-surface-100",children:"Create New Control"}),e.jsx("p",{className:"text-surface-400 mt-1",children:"Add a new control to your compliance program"})]}),e.jsxs("form",{onSubmit:g,className:"card p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"controlId",className:"block text-sm font-medium text-surface-300 mb-1",children:["Control ID ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{id:"controlId",type:"text",value:a.controlId,onChange:t=>n("controlId",t.target.value),placeholder:"e.g., AC-001, SOC2-CC6.1",className:`input ${s.controlId?"border-red-500":""}`}),s.controlId&&e.jsx("p",{className:"mt-1 text-sm text-red-400",children:s.controlId}),e.jsx("p",{className:"mt-1 text-xs text-surface-500",children:"A unique identifier for this control (e.g., AC-001, SOC2-CC6.1)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-surface-300 mb-1",children:["Title ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{id:"title",type:"text",value:a.title,onChange:t=>n("title",t.target.value),placeholder:"Enter control title",className:`input ${s.title?"border-red-500":""}`}),s.title&&e.jsx("p",{className:"mt-1 text-sm text-red-400",children:s.title})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-surface-300 mb-1",children:["Category ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("select",{id:"category",value:a.category,onChange:t=>n("category",t.target.value),className:"input",children:S.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-surface-300 mb-1",children:["Description ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("textarea",{id:"description",value:a.description,onChange:t=>n("description",t.target.value),placeholder:"Describe the control objective and requirements",rows:4,className:`input ${s.description?"border-red-500":""}`}),s.description&&e.jsx("p",{className:"mt-1 text-sm text-red-400",children:s.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-surface-300 mb-1",children:"Tags"}),e.jsx("input",{id:"tags",type:"text",value:c,onChange:t=>b(t.target.value),placeholder:"Enter tags separated by commas",className:"input"}),e.jsx("p",{className:"mt-1 text-xs text-surface-500",children:"Separate multiple tags with commas (e.g., SOC2, ISO27001, GDPR)"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-surface-700",children:[e.jsx(x,{type:"button",variant:"secondary",onClick:()=>d("/controls"),children:"Cancel"}),e.jsx(x,{type:"submit",disabled:i.isPending,children:i.isPending?"Creating...":"Create Control"})]})]})]})}export{_ as default};
